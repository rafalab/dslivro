<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 tidyverse | Introdução à Ciência de Dados</title>
  <meta name="description" content="Este livro apresenta conceitos e habilidades que ajudarão você a enfrentar os desafios da vida real em análise de dados. Ele abrange conceitos de probabilidade, inferência estatística, regressão linear e aprendizado de máquina. Além disso, permitirá que você desenvolva habilidades como programação em R, manipulação de dados com dplyr, visualização de dados com ggplot2, organização de arquivos no ambiente UNIX/Linux, controle de versão com GitHub e elaboração de documentos reprodutíveis com Rmarkdown." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 tidyverse | Introdução à Ciência de Dados" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este livro apresenta conceitos e habilidades que ajudarão você a enfrentar os desafios da vida real em análise de dados. Ele abrange conceitos de probabilidade, inferência estatística, regressão linear e aprendizado de máquina. Além disso, permitirá que você desenvolva habilidades como programação em R, manipulação de dados com dplyr, visualização de dados com ggplot2, organização de arquivos no ambiente UNIX/Linux, controle de versão com GitHub e elaboração de documentos reprodutíveis com Rmarkdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 tidyverse | Introdução à Ciência de Dados" />
  
  <meta name="twitter:description" content="Este livro apresenta conceitos e habilidades que ajudarão você a enfrentar os desafios da vida real em análise de dados. Ele abrange conceitos de probabilidade, inferência estatística, regressão linear e aprendizado de máquina. Além disso, permitirá que você desenvolva habilidades como programação em R, manipulação de dados com dplyr, visualização de dados com ggplot2, organização de arquivos no ambiente UNIX/Linux, controle de versão com GitHub e elaboração de documentos reprodutíveis com Rmarkdown." />
  

<meta name="author" content="Rafael A. Irizarry" />


<meta name="date" content="2020-11-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="conceitos-básicos-de-programação.html"/>
<link rel="next" href="importing-data.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução à Ciência de Dados</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="" data-path="agradecimentos.html"><a href="agradecimentos.html"><i class="fa fa-check"></i>Agradecimentos</a></li>
<li class="chapter" data-level="" data-path="introdução.html"><a href="introdução.html"><i class="fa fa-check"></i>Introdução</a>
<ul>
<li class="chapter" data-level="" data-path="introdução.html"><a href="introdução.html#estudos-de-caso"><i class="fa fa-check"></i>Estudos de Caso</a></li>
<li class="chapter" data-level="" data-path="introdução.html"><a href="introdução.html#quem-achará-este-livro-útil"><i class="fa fa-check"></i>Quem achará este livro útil?</a></li>
<li class="chapter" data-level="" data-path="introdução.html"><a href="introdução.html#o-que-este-livro-cobre"><i class="fa fa-check"></i>O que este livro cobre?</a></li>
<li class="chapter" data-level="" data-path="introdução.html"><a href="introdução.html#o-que-este-livro-não-cobre"><i class="fa fa-check"></i>O que este livro não cobre?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Introdução ao R e RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#por-que-r"><i class="fa fa-check"></i><b>1.1</b> Por que R?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#o-console-do-r"><i class="fa fa-check"></i><b>1.2</b> O console do R</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#scripts"><i class="fa fa-check"></i><b>1.3</b> <em>Scripts</em></a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#rstudio"><i class="fa fa-check"></i><b>1.4</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="getting-started.html"><a href="getting-started.html#painéis"><i class="fa fa-check"></i><b>1.4.1</b> Painéis</a></li>
<li class="chapter" data-level="1.4.2" data-path="getting-started.html"><a href="getting-started.html#combinações-de-teclas-atalhos"><i class="fa fa-check"></i><b>1.4.2</b> Combinações de teclas (atalhos)</a></li>
<li class="chapter" data-level="1.4.3" data-path="getting-started.html"><a href="getting-started.html#como-executar-comandos-enquanto-edita-scripts"><i class="fa fa-check"></i><b>1.4.3</b> Como executar comandos enquanto edita <em>scripts</em></a></li>
<li class="chapter" data-level="1.4.4" data-path="getting-started.html"><a href="getting-started.html#como-alterar-opções-globais"><i class="fa fa-check"></i><b>1.4.4</b> Como alterar opções globais</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#instalando-pacotes-r"><i class="fa fa-check"></i><b>1.5</b> Instalando pacotes R</a></li>
</ul></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> R básico</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-basics.html"><a href="r-basics.html#estudo-de-caso-assassinatos-por-armas-nos-eua"><i class="fa fa-check"></i><b>2.1</b> Estudo de caso: assassinatos por armas nos EUA</a></li>
<li class="chapter" data-level="2.2" data-path="r-basics.html"><a href="r-basics.html#os-princípios-básicos"><i class="fa fa-check"></i><b>2.2</b> Os princípios básicos</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="r-basics.html"><a href="r-basics.html#objetos"><i class="fa fa-check"></i><b>2.2.1</b> Objetos</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-basics.html"><a href="r-basics.html#a-área-de-trabalho-workspace"><i class="fa fa-check"></i><b>2.2.2</b> A área de trabalho (<em>workspace</em>)</a></li>
<li class="chapter" data-level="2.2.3" data-path="r-basics.html"><a href="r-basics.html#funções"><i class="fa fa-check"></i><b>2.2.3</b> Funções</a></li>
<li class="chapter" data-level="2.2.4" data-path="r-basics.html"><a href="r-basics.html#outros-objetos-pré-construídos"><i class="fa fa-check"></i><b>2.2.4</b> Outros objetos pré-construídos</a></li>
<li class="chapter" data-level="2.2.5" data-path="r-basics.html"><a href="r-basics.html#nomes-de-variáveis"><i class="fa fa-check"></i><b>2.2.5</b> Nomes de variáveis</a></li>
<li class="chapter" data-level="2.2.6" data-path="r-basics.html"><a href="r-basics.html#como-salvar-sua-área-de-trabalho"><i class="fa fa-check"></i><b>2.2.6</b> Como salvar sua área de trabalho</a></li>
<li class="chapter" data-level="2.2.7" data-path="r-basics.html"><a href="r-basics.html#fundamentando-o-uso-de-scripts"><i class="fa fa-check"></i><b>2.2.7</b> Fundamentando o uso de <em>scripts</em></a></li>
<li class="chapter" data-level="2.2.8" data-path="r-basics.html"><a href="r-basics.html#como-comentar-seu-código"><i class="fa fa-check"></i><b>2.2.8</b> Como comentar seu código</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html#exercícios"><i class="fa fa-check"></i><b>2.3</b> Exercícios</a></li>
<li class="chapter" data-level="2.4" data-path="r-basics.html"><a href="r-basics.html#tipos-de-dados"><i class="fa fa-check"></i><b>2.4</b> Tipos de dados</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="r-basics.html"><a href="r-basics.html#data-frames"><i class="fa fa-check"></i><b>2.4.1</b> <em>Data frames</em></a></li>
<li class="chapter" data-level="2.4.2" data-path="r-basics.html"><a href="r-basics.html#examinando-um-objeto"><i class="fa fa-check"></i><b>2.4.2</b> Examinando um objeto</a></li>
<li class="chapter" data-level="2.4.3" data-path="r-basics.html"><a href="r-basics.html#o-operador-de-acesso"><i class="fa fa-check"></i><b>2.4.3</b> O operador de acesso: <code>$</code></a></li>
<li class="chapter" data-level="2.4.4" data-path="r-basics.html"><a href="r-basics.html#vetores-numéricos-caracteres-e-lógicos"><i class="fa fa-check"></i><b>2.4.4</b> Vetores: numéricos, caracteres e lógicos</a></li>
<li class="chapter" data-level="2.4.5" data-path="r-basics.html"><a href="r-basics.html#fatores-factors"><i class="fa fa-check"></i><b>2.4.5</b> Fatores (<em>factors</em>)</a></li>
<li class="chapter" data-level="2.4.6" data-path="r-basics.html"><a href="r-basics.html#listas"><i class="fa fa-check"></i><b>2.4.6</b> Listas</a></li>
<li class="chapter" data-level="2.4.7" data-path="r-basics.html"><a href="r-basics.html#matrizes"><i class="fa fa-check"></i><b>2.4.7</b> Matrizes</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r-basics.html"><a href="r-basics.html#exercícios-1"><i class="fa fa-check"></i><b>2.5</b> Exercícios</a></li>
<li class="chapter" data-level="2.6" data-path="r-basics.html"><a href="r-basics.html#vetores"><i class="fa fa-check"></i><b>2.6</b> Vetores</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="r-basics.html"><a href="r-basics.html#criando-vetores"><i class="fa fa-check"></i><b>2.6.1</b> Criando vetores</a></li>
<li class="chapter" data-level="2.6.2" data-path="r-basics.html"><a href="r-basics.html#nomes"><i class="fa fa-check"></i><b>2.6.2</b> Nomes</a></li>
<li class="chapter" data-level="2.6.3" data-path="r-basics.html"><a href="r-basics.html#sequências"><i class="fa fa-check"></i><b>2.6.3</b> Sequências</a></li>
<li class="chapter" data-level="2.6.4" data-path="r-basics.html"><a href="r-basics.html#criando-subconjuntos"><i class="fa fa-check"></i><b>2.6.4</b> Criando subconjuntos</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="r-basics.html"><a href="r-basics.html#conversão-forçada"><i class="fa fa-check"></i><b>2.7</b> Conversão forçada</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="r-basics.html"><a href="r-basics.html#valores-na"><i class="fa fa-check"></i><b>2.7.1</b> Valores NA</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="r-basics.html"><a href="r-basics.html#exercícios-2"><i class="fa fa-check"></i><b>2.8</b> Exercícios</a></li>
<li class="chapter" data-level="2.9" data-path="r-basics.html"><a href="r-basics.html#ordenação"><i class="fa fa-check"></i><b>2.9</b> Ordenação</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="r-basics.html"><a href="r-basics.html#sort"><i class="fa fa-check"></i><b>2.9.1</b> <code>sort</code></a></li>
<li class="chapter" data-level="2.9.2" data-path="r-basics.html"><a href="r-basics.html#order"><i class="fa fa-check"></i><b>2.9.2</b> <code>order</code></a></li>
<li class="chapter" data-level="2.9.3" data-path="r-basics.html"><a href="r-basics.html#max-e-which.max"><i class="fa fa-check"></i><b>2.9.3</b> <code>max</code> e <code>which.max</code></a></li>
<li class="chapter" data-level="2.9.4" data-path="r-basics.html"><a href="r-basics.html#rank"><i class="fa fa-check"></i><b>2.9.4</b> <code>rank</code></a></li>
<li class="chapter" data-level="2.9.5" data-path="r-basics.html"><a href="r-basics.html#cuidado-com-a-reciclagem"><i class="fa fa-check"></i><b>2.9.5</b> Cuidado com a reciclagem</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="r-basics.html"><a href="r-basics.html#exercícios-3"><i class="fa fa-check"></i><b>2.10</b> Exercícios</a></li>
<li class="chapter" data-level="2.11" data-path="r-basics.html"><a href="r-basics.html#aritmética-vetorial"><i class="fa fa-check"></i><b>2.11</b> Aritmética vetorial</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="r-basics.html"><a href="r-basics.html#reescalonando-um-vetor"><i class="fa fa-check"></i><b>2.11.1</b> Reescalonando um vetor</a></li>
<li class="chapter" data-level="2.11.2" data-path="r-basics.html"><a href="r-basics.html#dois-vetores"><i class="fa fa-check"></i><b>2.11.2</b> Dois vetores</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="r-basics.html"><a href="r-basics.html#exercícios-4"><i class="fa fa-check"></i><b>2.12</b> Exercícios</a></li>
<li class="chapter" data-level="2.13" data-path="r-basics.html"><a href="r-basics.html#indexação"><i class="fa fa-check"></i><b>2.13</b> Indexação</a>
<ul>
<li class="chapter" data-level="2.13.1" data-path="r-basics.html"><a href="r-basics.html#criando-subconjuntos-com-objetos-do-tipo-lógico"><i class="fa fa-check"></i><b>2.13.1</b> Criando subconjuntos com objetos do tipo lógico</a></li>
<li class="chapter" data-level="2.13.2" data-path="r-basics.html"><a href="r-basics.html#operadores-lógicos"><i class="fa fa-check"></i><b>2.13.2</b> Operadores lógicos</a></li>
<li class="chapter" data-level="2.13.3" data-path="r-basics.html"><a href="r-basics.html#which"><i class="fa fa-check"></i><b>2.13.3</b> <code>which</code></a></li>
<li class="chapter" data-level="2.13.4" data-path="r-basics.html"><a href="r-basics.html#match"><i class="fa fa-check"></i><b>2.13.4</b> <code>match</code></a></li>
<li class="chapter" data-level="2.13.5" data-path="r-basics.html"><a href="r-basics.html#in"><i class="fa fa-check"></i><b>2.13.5</b> <code>%in%</code></a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="r-basics.html"><a href="r-basics.html#exercícios-5"><i class="fa fa-check"></i><b>2.14</b> Exercícios</a></li>
<li class="chapter" data-level="2.15" data-path="r-basics.html"><a href="r-basics.html#gráficos-básicos"><i class="fa fa-check"></i><b>2.15</b> Gráficos básicos</a>
<ul>
<li class="chapter" data-level="2.15.1" data-path="r-basics.html"><a href="r-basics.html#plot"><i class="fa fa-check"></i><b>2.15.1</b> <code>plot</code></a></li>
<li class="chapter" data-level="2.15.2" data-path="r-basics.html"><a href="r-basics.html#hist"><i class="fa fa-check"></i><b>2.15.2</b> <code>hist</code></a></li>
<li class="chapter" data-level="2.15.3" data-path="r-basics.html"><a href="r-basics.html#boxplot"><i class="fa fa-check"></i><b>2.15.3</b> <code>boxplot</code></a></li>
<li class="chapter" data-level="2.15.4" data-path="r-basics.html"><a href="r-basics.html#image"><i class="fa fa-check"></i><b>2.15.4</b> <code>image</code></a></li>
</ul></li>
<li class="chapter" data-level="2.16" data-path="r-basics.html"><a href="r-basics.html#exercícios-6"><i class="fa fa-check"></i><b>2.16</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="conceitos-básicos-de-programação.html"><a href="conceitos-básicos-de-programação.html"><i class="fa fa-check"></i><b>3</b> Conceitos básicos de programação</a>
<ul>
<li class="chapter" data-level="3.1" data-path="conceitos-básicos-de-programação.html"><a href="conceitos-básicos-de-programação.html#conditionals"><i class="fa fa-check"></i><b>3.1</b> Expressões condicionais</a></li>
<li class="chapter" data-level="3.2" data-path="conceitos-básicos-de-programação.html"><a href="conceitos-básicos-de-programação.html#como-definir-funções"><i class="fa fa-check"></i><b>3.2</b> Como definir funções</a></li>
<li class="chapter" data-level="3.3" data-path="conceitos-básicos-de-programação.html"><a href="conceitos-básicos-de-programação.html#namespaces"><i class="fa fa-check"></i><b>3.3</b> <em>Namespaces</em></a></li>
<li class="chapter" data-level="3.4" data-path="conceitos-básicos-de-programação.html"><a href="conceitos-básicos-de-programação.html#laços-do-tipo-for"><i class="fa fa-check"></i><b>3.4</b> Laços do tipo for</a></li>
<li class="chapter" data-level="3.5" data-path="conceitos-básicos-de-programação.html"><a href="conceitos-básicos-de-programação.html#vectorization"><i class="fa fa-check"></i><b>3.5</b> Vectorização e funcionais</a></li>
<li class="chapter" data-level="3.6" data-path="conceitos-básicos-de-programação.html"><a href="conceitos-básicos-de-programação.html#exercícios-7"><i class="fa fa-check"></i><b>3.6</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4</b> <em>tidyverse</em></a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyverse.html"><a href="tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>4.1</b> Data <em>tidy</em></a></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html#exercícios-8"><i class="fa fa-check"></i><b>4.2</b> Exercícios</a></li>
<li class="chapter" data-level="4.3" data-path="tidyverse.html"><a href="tidyverse.html#como-manipular-data-frames"><i class="fa fa-check"></i><b>4.3</b> Como manipular <em>data frames</em></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tidyverse.html"><a href="tidyverse.html#como-adicionar-uma-coluna-com-mutate"><i class="fa fa-check"></i><b>4.3.1</b> Como adicionar uma coluna com <code>mutate</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="tidyverse.html"><a href="tidyverse.html#como-criar-subconjuntos-com-filter"><i class="fa fa-check"></i><b>4.3.2</b> Como criar subconjuntos com <code>filter</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="tidyverse.html"><a href="tidyverse.html#como-selecionar-colunas-com-select"><i class="fa fa-check"></i><b>4.3.3</b> Como selecionar colunas com <code>select</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tidyverse.html"><a href="tidyverse.html#exercícios-9"><i class="fa fa-check"></i><b>4.4</b> Exercícios</a></li>
<li class="chapter" data-level="4.5" data-path="tidyverse.html"><a href="tidyverse.html#o-cano_"><i class="fa fa-check"></i><b>4.5</b> O cano_: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.6" data-path="tidyverse.html"><a href="tidyverse.html#exercícios-10"><i class="fa fa-check"></i><b>4.6</b> Exercícios</a></li>
<li class="chapter" data-level="4.7" data-path="tidyverse.html"><a href="tidyverse.html#como-resumir-dados"><i class="fa fa-check"></i><b>4.7</b> Como resumir dados</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="tidyverse.html"><a href="tidyverse.html#summarize"><i class="fa fa-check"></i><b>4.7.1</b> <code>summarize</code></a></li>
<li class="chapter" data-level="4.7.2" data-path="tidyverse.html"><a href="tidyverse.html#pull"><i class="fa fa-check"></i><b>4.7.2</b> <code>pull</code></a></li>
<li class="chapter" data-level="4.7.3" data-path="tidyverse.html"><a href="tidyverse.html#group-by"><i class="fa fa-check"></i><b>4.7.3</b> Como agrupar e resumir com <code>group_by</code></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="tidyverse.html"><a href="tidyverse.html#como-encomendar-os-data-frames"><i class="fa fa-check"></i><b>4.8</b> Como encomendar os <em>data frames</em></a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="tidyverse.html"><a href="tidyverse.html#como-encomendar-aninhado"><i class="fa fa-check"></i><b>4.8.1</b> Como encomendar aninhado</a></li>
<li class="chapter" data-level="4.8.2" data-path="tidyverse.html"><a href="tidyverse.html#os-primeiros-n"><i class="fa fa-check"></i><b>4.8.2</b> Os primeiros <span class="math inline">\(n\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="tidyverse.html"><a href="tidyverse.html#exercícios-11"><i class="fa fa-check"></i><b>4.9</b> Exercícios</a></li>
<li class="chapter" data-level="4.10" data-path="tidyverse.html"><a href="tidyverse.html#tibbles"><i class="fa fa-check"></i><b>4.10</b> <em>Tibbles</em></a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="tidyverse.html"><a href="tidyverse.html#tibbles-parece-melhor"><i class="fa fa-check"></i><b>4.10.1</b> <em>Tibbles</em> parece melhor</a></li>
<li class="chapter" data-level="4.10.2" data-path="tidyverse.html"><a href="tidyverse.html#tibbles_subconjuntos-são_tibbles"><i class="fa fa-check"></i><b>4.10.2</b> <em>Tibbles_subconjuntos são_tibbles</em></a></li>
<li class="chapter" data-level="4.10.3" data-path="tidyverse.html"><a href="tidyverse.html#tibbles-pode-ter-entradas-complexas"><i class="fa fa-check"></i><b>4.10.3</b> <em>Tibbles</em> pode ter entradas complexas</a></li>
<li class="chapter" data-level="4.10.4" data-path="tidyverse.html"><a href="tidyverse.html#tibbles-podem-ser-agrupados"><i class="fa fa-check"></i><b>4.10.4</b> <em>Tibbles</em> podem ser agrupados</a></li>
<li class="chapter" data-level="4.10.5" data-path="tidyverse.html"><a href="tidyverse.html#como-criar-um-tibble-usando-tibble-ao-invés-de-data.frame"><i class="fa fa-check"></i><b>4.10.5</b> Como criar um <em>tibble</em> usando <code>tibble</code> ao invés de <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="tidyverse.html"><a href="tidyverse.html#o-operador-de-ponto"><i class="fa fa-check"></i><b>4.11</b> O operador de ponto</a></li>
<li class="chapter" data-level="4.12" data-path="tidyverse.html"><a href="tidyverse.html#do"><i class="fa fa-check"></i><b>4.12</b> <code>do</code></a></li>
<li class="chapter" data-level="4.13" data-path="tidyverse.html"><a href="tidyverse.html#o-pacote-purrr"><i class="fa fa-check"></i><b>4.13</b> O pacote <strong>purrr</strong></a></li>
<li class="chapter" data-level="4.14" data-path="tidyverse.html"><a href="tidyverse.html#os-condicionais-tidyverse"><i class="fa fa-check"></i><b>4.14</b> Os condicionais <em>tidyverse</em></a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="tidyverse.html"><a href="tidyverse.html#case_when"><i class="fa fa-check"></i><b>4.14.1</b> <code>case_when</code></a></li>
<li class="chapter" data-level="4.14.2" data-path="tidyverse.html"><a href="tidyverse.html#between"><i class="fa fa-check"></i><b>4.14.2</b> <code>between</code></a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="tidyverse.html"><a href="tidyverse.html#exercícios-12"><i class="fa fa-check"></i><b>4.15</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>5</b> Importando dados</a>
<ul>
<li class="chapter" data-level="5.1" data-path="importing-data.html"><a href="importing-data.html#caminhos-e-diretório-de-trabalho"><i class="fa fa-check"></i><b>5.1</b> Caminhos e diretório de trabalho</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="importing-data.html"><a href="importing-data.html#sistema-de-arquivos"><i class="fa fa-check"></i><b>5.1.1</b> Sistema de arquivos</a></li>
<li class="chapter" data-level="5.1.2" data-path="importing-data.html"><a href="importing-data.html#caminhos-relativos-e-absolutos"><i class="fa fa-check"></i><b>5.1.2</b> Caminhos relativos e absolutos</a></li>
<li class="chapter" data-level="5.1.3" data-path="importing-data.html"><a href="importing-data.html#o-diretório-de-trabalho"><i class="fa fa-check"></i><b>5.1.3</b> O diretório de trabalho</a></li>
<li class="chapter" data-level="5.1.4" data-path="importing-data.html"><a href="importing-data.html#gerando-nomes-de-caminhos"><i class="fa fa-check"></i><b>5.1.4</b> Gerando nomes de caminhos</a></li>
<li class="chapter" data-level="5.1.5" data-path="importing-data.html"><a href="importing-data.html#copiando-arquivos-usando-caminhos"><i class="fa fa-check"></i><b>5.1.5</b> Copiando arquivos usando caminhos</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="importing-data.html"><a href="importing-data.html#os-pacotes-readr-e-readxl"><i class="fa fa-check"></i><b>5.2</b> Os pacotes readr e readxl</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="importing-data.html"><a href="importing-data.html#readr"><i class="fa fa-check"></i><b>5.2.1</b> readr</a></li>
<li class="chapter" data-level="5.2.2" data-path="importing-data.html"><a href="importing-data.html#readxl"><i class="fa fa-check"></i><b>5.2.2</b> readxl</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="importing-data.html"><a href="importing-data.html#exercícios-13"><i class="fa fa-check"></i><b>5.3</b> Exercícios</a></li>
<li class="chapter" data-level="5.4" data-path="importing-data.html"><a href="importing-data.html#como-fazer-download-de-arquivos"><i class="fa fa-check"></i><b>5.4</b> Como fazer <em>download</em> de arquivos</a></li>
<li class="chapter" data-level="5.5" data-path="importing-data.html"><a href="importing-data.html#funções-básicas-de-importação-do-r"><i class="fa fa-check"></i><b>5.5</b> Funções básicas de importação do R</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="importing-data.html"><a href="importing-data.html#scan"><i class="fa fa-check"></i><b>5.5.1</b> <code>scan</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="importing-data.html"><a href="importing-data.html#arquivos-de-texto-versus-arquivos-binários"><i class="fa fa-check"></i><b>5.6</b> Arquivos de texto versus arquivos binários</a></li>
<li class="chapter" data-level="5.7" data-path="importing-data.html"><a href="importing-data.html#unicode-versus-ascii"><i class="fa fa-check"></i><b>5.7</b> Unicode versus ASCII</a></li>
<li class="chapter" data-level="5.8" data-path="importing-data.html"><a href="importing-data.html#como-organizar-dados-com-planilhas"><i class="fa fa-check"></i><b>5.8</b> Como organizar dados com planilhas</a></li>
<li class="chapter" data-level="5.9" data-path="importing-data.html"><a href="importing-data.html#exercícios-14"><i class="fa fa-check"></i><b>5.9</b> Exercícios</a></li>
</ul></li>
<li class="part"><span><b>II Exibição de dados</b></span></li>
<li class="chapter" data-level="6" data-path="introdução-à-visualização-de-dados.html"><a href="introdução-à-visualização-de-dados.html"><i class="fa fa-check"></i><b>6</b> Introdução à visualização de dados</a></li>
<li class="chapter" data-level="7" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>7</b> ggplot2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ggplot2.html"><a href="ggplot2.html#os-componentes-de-um-gráfico"><i class="fa fa-check"></i><b>7.1</b> Os componentes de um gráfico</a></li>
<li class="chapter" data-level="7.2" data-path="ggplot2.html"><a href="ggplot2.html#objetos-ggplot"><i class="fa fa-check"></i><b>7.2</b> Objetos <code>ggplot</code></a></li>
<li class="chapter" data-level="7.3" data-path="ggplot2.html"><a href="ggplot2.html#geometrias"><i class="fa fa-check"></i><b>7.3</b> Geometrias</a></li>
<li class="chapter" data-level="7.4" data-path="ggplot2.html"><a href="ggplot2.html#mapeamentos-estéticos"><i class="fa fa-check"></i><b>7.4</b> Mapeamentos estéticos</a></li>
<li class="chapter" data-level="7.5" data-path="ggplot2.html"><a href="ggplot2.html#camadas"><i class="fa fa-check"></i><b>7.5</b> Camadas</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ggplot2.html"><a href="ggplot2.html#trabalhando-com-argumentos"><i class="fa fa-check"></i><b>7.5.1</b> Trabalhando com argumentos</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ggplot2.html"><a href="ggplot2.html#mapeamento-estético-global-versus-local"><i class="fa fa-check"></i><b>7.6</b> Mapeamento estético global versus local</a></li>
<li class="chapter" data-level="7.7" data-path="ggplot2.html"><a href="ggplot2.html#escalas"><i class="fa fa-check"></i><b>7.7</b> Escalas</a></li>
<li class="chapter" data-level="7.8" data-path="ggplot2.html"><a href="ggplot2.html#rótulos-e-títulos"><i class="fa fa-check"></i><b>7.8</b> Rótulos e títulos</a></li>
<li class="chapter" data-level="7.9" data-path="ggplot2.html"><a href="ggplot2.html#usando-categorias-como-cores"><i class="fa fa-check"></i><b>7.9</b> Usando categorias como cores</a></li>
<li class="chapter" data-level="7.10" data-path="ggplot2.html"><a href="ggplot2.html#anotações-formas-e-ajustes"><i class="fa fa-check"></i><b>7.10</b> Anotações, formas e ajustes</a></li>
<li class="chapter" data-level="7.11" data-path="ggplot2.html"><a href="ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>7.11</b> Pacotes complementares</a></li>
<li class="chapter" data-level="7.12" data-path="ggplot2.html"><a href="ggplot2.html#como-combinar-tudo"><i class="fa fa-check"></i><b>7.12</b> Como combinar tudo</a></li>
<li class="chapter" data-level="7.13" data-path="ggplot2.html"><a href="ggplot2.html#qplot"><i class="fa fa-check"></i><b>7.13</b> Gráficos rápidos com <code>qplot</code></a></li>
<li class="chapter" data-level="7.14" data-path="ggplot2.html"><a href="ggplot2.html#grade-de-gráficos"><i class="fa fa-check"></i><b>7.14</b> Grade de gráficos</a></li>
<li class="chapter" data-level="7.15" data-path="ggplot2.html"><a href="ggplot2.html#exercícios-15"><i class="fa fa-check"></i><b>7.15</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>8</b> Visualizando distribuições de dados</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distributions.html"><a href="distributions.html#tipos-de-variáveis"><i class="fa fa-check"></i><b>8.1</b> Tipos de variáveis</a></li>
<li class="chapter" data-level="8.2" data-path="distributions.html"><a href="distributions.html#estudo-de-caso-descrevendo-a-altura-dos-alunos"><i class="fa fa-check"></i><b>8.2</b> Estudo de caso: descrevendo a altura dos alunos</a></li>
<li class="chapter" data-level="8.3" data-path="distributions.html"><a href="distributions.html#função-de-distribuição"><i class="fa fa-check"></i><b>8.3</b> Função de distribuição</a></li>
<li class="chapter" data-level="8.4" data-path="distributions.html"><a href="distributions.html#cdf-intro"><i class="fa fa-check"></i><b>8.4</b> Funções de distribuição acumulada</a></li>
<li class="chapter" data-level="8.5" data-path="distributions.html"><a href="distributions.html#histogramas"><i class="fa fa-check"></i><b>8.5</b> Histogramas</a></li>
<li class="chapter" data-level="8.6" data-path="distributions.html"><a href="distributions.html#curvas-de-densidade"><i class="fa fa-check"></i><b>8.6</b> Curvas de densidade</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="distributions.html"><a href="distributions.html#interpretando-o-eixo-y"><i class="fa fa-check"></i><b>8.6.1</b> Interpretando o eixo y</a></li>
<li class="chapter" data-level="8.6.2" data-path="distributions.html"><a href="distributions.html#densidades-permitem-a-estratificação"><i class="fa fa-check"></i><b>8.6.2</b> Densidades permitem a estratificação</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="distributions.html"><a href="distributions.html#exercícios-16"><i class="fa fa-check"></i><b>8.7</b> Exercícios</a></li>
<li class="chapter" data-level="8.8" data-path="distributions.html"><a href="distributions.html#normal-distribution"><i class="fa fa-check"></i><b>8.8</b> Distribuição normal</a></li>
<li class="chapter" data-level="8.9" data-path="distributions.html"><a href="distributions.html#unidades-padrão"><i class="fa fa-check"></i><b>8.9</b> Unidades padrão</a></li>
<li class="chapter" data-level="8.10" data-path="distributions.html"><a href="distributions.html#gráficos-qq"><i class="fa fa-check"></i><b>8.10</b> Gráficos QQ</a></li>
<li class="chapter" data-level="8.11" data-path="distributions.html"><a href="distributions.html#percentis"><i class="fa fa-check"></i><b>8.11</b> Percentis</a></li>
<li class="chapter" data-level="8.12" data-path="distributions.html"><a href="distributions.html#diagramas-de-caixas-boxplots"><i class="fa fa-check"></i><b>8.12</b> Diagramas de caixas (<em>boxplots</em>)</a></li>
<li class="chapter" data-level="8.13" data-path="distributions.html"><a href="distributions.html#stratification"><i class="fa fa-check"></i><b>8.13</b> Estratificação</a></li>
<li class="chapter" data-level="8.14" data-path="distributions.html"><a href="distributions.html#student-height-cont"><i class="fa fa-check"></i><b>8.14</b> Estudo de caso: descrevendo as alturas dos alunos (continuação)</a></li>
<li class="chapter" data-level="8.15" data-path="distributions.html"><a href="distributions.html#exercícios-17"><i class="fa fa-check"></i><b>8.15</b> Exercícios</a></li>
<li class="chapter" data-level="8.16" data-path="distributions.html"><a href="distributions.html#other-geometries"><i class="fa fa-check"></i><b>8.16</b> Geometrias ggplot2</a>
<ul>
<li class="chapter" data-level="8.16.1" data-path="distributions.html"><a href="distributions.html#gráficos-de-barra"><i class="fa fa-check"></i><b>8.16.1</b> Gráficos de barra</a></li>
<li class="chapter" data-level="8.16.2" data-path="distributions.html"><a href="distributions.html#histogramas-1"><i class="fa fa-check"></i><b>8.16.2</b> Histogramas</a></li>
<li class="chapter" data-level="8.16.3" data-path="distributions.html"><a href="distributions.html#gráficos-de-densidade"><i class="fa fa-check"></i><b>8.16.3</b> Gráficos de densidade</a></li>
<li class="chapter" data-level="8.16.4" data-path="distributions.html"><a href="distributions.html#boxplots"><i class="fa fa-check"></i><b>8.16.4</b> <em>Boxplots</em></a></li>
<li class="chapter" data-level="8.16.5" data-path="distributions.html"><a href="distributions.html#gráficos-qq-1"><i class="fa fa-check"></i><b>8.16.5</b> Gráficos QQ</a></li>
<li class="chapter" data-level="8.16.6" data-path="distributions.html"><a href="distributions.html#imagens"><i class="fa fa-check"></i><b>8.16.6</b> Imagens</a></li>
<li class="chapter" data-level="8.16.7" data-path="distributions.html"><a href="distributions.html#gráficos-rápidos"><i class="fa fa-check"></i><b>8.16.7</b> Gráficos rápidos</a></li>
</ul></li>
<li class="chapter" data-level="8.17" data-path="distributions.html"><a href="distributions.html#exercícios-18"><i class="fa fa-check"></i><b>8.17</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gapminder.html"><a href="gapminder.html"><i class="fa fa-check"></i><b>9</b> Visualização de dados na prática</a>
<ul>
<li class="chapter" data-level="9.1" data-path="gapminder.html"><a href="gapminder.html#estudo-de-caso-novas-perspectivas-sobre-pobreza"><i class="fa fa-check"></i><b>9.1</b> Estudo de caso: novas perspectivas sobre pobreza</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="gapminder.html"><a href="gapminder.html#teste-de-hans-rosling"><i class="fa fa-check"></i><b>9.1.1</b> Teste de Hans Rosling</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="gapminder.html"><a href="gapminder.html#diagramas-de-dispersão-scatterplots"><i class="fa fa-check"></i><b>9.2</b> Diagramas de dispersão (<em>scatterplots</em>)</a></li>
<li class="chapter" data-level="9.3" data-path="gapminder.html"><a href="gapminder.html#separe-em-facetas"><i class="fa fa-check"></i><b>9.3</b> Separe em facetas</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="gapminder.html"><a href="gapminder.html#facet_wrap"><i class="fa fa-check"></i><b>9.3.1</b> <code>facet_wrap</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="gapminder.html"><a href="gapminder.html#escalas-fixas-para-melhores-comparações"><i class="fa fa-check"></i><b>9.3.2</b> Escalas fixas para melhores comparações</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="gapminder.html"><a href="gapminder.html#gráficos-de-séries-temporais"><i class="fa fa-check"></i><b>9.4</b> Gráficos de séries temporais</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="gapminder.html"><a href="gapminder.html#rótulos-em-vez-de-legendas"><i class="fa fa-check"></i><b>9.4.1</b> Rótulos em vez de legendas</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="gapminder.html"><a href="gapminder.html#transformações-de-dados"><i class="fa fa-check"></i><b>9.5</b> Transformações de dados</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="gapminder.html"><a href="gapminder.html#transformação-logarítmica"><i class="fa fa-check"></i><b>9.5.1</b> Transformação logarítmica</a></li>
<li class="chapter" data-level="9.5.2" data-path="gapminder.html"><a href="gapminder.html#qual-base"><i class="fa fa-check"></i><b>9.5.2</b> Qual base?</a></li>
<li class="chapter" data-level="9.5.3" data-path="gapminder.html"><a href="gapminder.html#transformar-os-valores-ou-a-escala"><i class="fa fa-check"></i><b>9.5.3</b> Transformar os valores ou a escala?</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="gapminder.html"><a href="gapminder.html#como-visualizar-distribuições-multimodais"><i class="fa fa-check"></i><b>9.6</b> Como visualizar distribuições multimodais</a></li>
<li class="chapter" data-level="9.7" data-path="gapminder.html"><a href="gapminder.html#como-comparar-múltiplas-distribuições-com-boxplots-e-gráficos-ridge"><i class="fa fa-check"></i><b>9.7</b> Como comparar múltiplas distribuições com <em>boxplots</em> e gráficos <em>ridge</em></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="gapminder.html"><a href="gapminder.html#boxplots-diagramas-de-caixa"><i class="fa fa-check"></i><b>9.7.1</b> <em>Boxplots</em> (diagramas de caixa)</a></li>
<li class="chapter" data-level="9.7.2" data-path="gapminder.html"><a href="gapminder.html#gráficos-ridge"><i class="fa fa-check"></i><b>9.7.2</b> Gráficos <em>ridge</em></a></li>
<li class="chapter" data-level="9.7.3" data-path="gapminder.html"><a href="gapminder.html#exemplo-distribuições-de-renda-1970-versus-2010"><i class="fa fa-check"></i><b>9.7.3</b> Exemplo: distribuições de renda 1970 versus 2010</a></li>
<li class="chapter" data-level="9.7.4" data-path="gapminder.html"><a href="gapminder.html#como-acessar-variáveis-calculadas"><i class="fa fa-check"></i><b>9.7.4</b> Como acessar variáveis calculadas</a></li>
<li class="chapter" data-level="9.7.5" data-path="gapminder.html"><a href="gapminder.html#densidades-ponderadas"><i class="fa fa-check"></i><b>9.7.5</b> Densidades ponderadas</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="gapminder.html"><a href="gapminder.html#a-falácia-ecológica-e-a-importância-de-mostrar-os-dados"><i class="fa fa-check"></i><b>9.8</b> A falácia ecológica e a importância de mostrar os dados</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="gapminder.html"><a href="gapminder.html#logit"><i class="fa fa-check"></i><b>9.8.1</b> Transformação logística</a></li>
<li class="chapter" data-level="9.8.2" data-path="gapminder.html"><a href="gapminder.html#mostre-os-dados"><i class="fa fa-check"></i><b>9.8.2</b> Mostre os dados</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html"><i class="fa fa-check"></i><b>10</b> Princípios de visualização de dados</a>
<ul>
<li class="chapter" data-level="10.1" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#codificando-dados-usando-dicas-visuais"><i class="fa fa-check"></i><b>10.1</b> Codificando dados usando dicas visuais</a></li>
<li class="chapter" data-level="10.2" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#saiba-quando-incluir-0"><i class="fa fa-check"></i><b>10.2</b> Saiba quando incluir 0</a></li>
<li class="chapter" data-level="10.3" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#não-distorça-quantidades"><i class="fa fa-check"></i><b>10.3</b> Não distorça quantidades</a></li>
<li class="chapter" data-level="10.4" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#ordenando-categorias-por-um-valor-significativo"><i class="fa fa-check"></i><b>10.4</b> Ordenando categorias por um valor significativo</a></li>
<li class="chapter" data-level="10.5" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#mostre-os-dados-1"><i class="fa fa-check"></i><b>10.5</b> Mostre os dados</a></li>
<li class="chapter" data-level="10.6" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#facilite-comparações"><i class="fa fa-check"></i><b>10.6</b> Facilite comparações</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#use-eixos-em-comum"><i class="fa fa-check"></i><b>10.6.1</b> Use eixos em comum</a></li>
<li class="chapter" data-level="10.6.2" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#alinhe-os-gráficos-verticalmente-para-ver-alterações-horizontais-e-horizontalmente-para-ver-alterações-verticais"><i class="fa fa-check"></i><b>10.6.2</b> Alinhe os gráficos verticalmente para ver alterações horizontais e horizontalmente para ver alterações verticais</a></li>
<li class="chapter" data-level="10.6.3" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#considere-transformações"><i class="fa fa-check"></i><b>10.6.3</b> Considere transformações</a></li>
<li class="chapter" data-level="10.6.4" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#as-indicações-visuais-comparadas-devem-ser-adjacentes"><i class="fa fa-check"></i><b>10.6.4</b> As indicações visuais comparadas devem ser adjacentes</a></li>
<li class="chapter" data-level="10.6.5" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#use-cores"><i class="fa fa-check"></i><b>10.6.5</b> Use cores</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#pense-no-daltônico"><i class="fa fa-check"></i><b>10.7</b> Pense no daltônico</a></li>
<li class="chapter" data-level="10.8" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#plotagens-para-duas-variáveis"><i class="fa fa-check"></i><b>10.8</b> Plotagens para duas variáveis</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#gráficos-de-inclinação"><i class="fa fa-check"></i><b>10.8.1</b> Gráficos de inclinação</a></li>
<li class="chapter" data-level="10.8.2" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#gráfico-de-bland-altman"><i class="fa fa-check"></i><b>10.8.2</b> Gráfico de Bland-Altman</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#codificando-uma-terceira-variável"><i class="fa fa-check"></i><b>10.9</b> Codificando uma terceira variável</a></li>
<li class="chapter" data-level="10.10" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#evite-gráficos-pseudo-tridimensionais"><i class="fa fa-check"></i><b>10.10</b> Evite gráficos pseudo-tridimensionais</a></li>
<li class="chapter" data-level="10.11" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#evite-muitos-dígitos-significativos"><i class="fa fa-check"></i><b>10.11</b> Evite muitos dígitos significativos</a></li>
<li class="chapter" data-level="10.12" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#conheça-seu-público"><i class="fa fa-check"></i><b>10.12</b> Conheça seu público</a></li>
<li class="chapter" data-level="10.13" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#exercícios-19"><i class="fa fa-check"></i><b>10.13</b> Exercícios</a></li>
<li class="chapter" data-level="10.14" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#vaccines"><i class="fa fa-check"></i><b>10.14</b> Estudo de caso: vacinas e doenças infecciosas</a></li>
<li class="chapter" data-level="10.15" data-path="princípios-de-visualização-de-dados.html"><a href="princípios-de-visualização-de-dados.html#exercícios-20"><i class="fa fa-check"></i><b>10.15</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="robust-summaries.html"><a href="robust-summaries.html"><i class="fa fa-check"></i><b>11</b> Resumos robustos</a>
<ul>
<li class="chapter" data-level="11.1" data-path="robust-summaries.html"><a href="robust-summaries.html#valores-atípicos"><i class="fa fa-check"></i><b>11.1</b> Valores atípicos</a></li>
<li class="chapter" data-level="11.2" data-path="robust-summaries.html"><a href="robust-summaries.html#mediana"><i class="fa fa-check"></i><b>11.2</b> Mediana</a></li>
<li class="chapter" data-level="11.3" data-path="robust-summaries.html"><a href="robust-summaries.html#o-intervalo-interquartil-iqr"><i class="fa fa-check"></i><b>11.3</b> O intervalo interquartil (IQR)</a></li>
<li class="chapter" data-level="11.4" data-path="robust-summaries.html"><a href="robust-summaries.html#definição-de-tukey-de-um-outlier"><i class="fa fa-check"></i><b>11.4</b> Definição de Tukey de um outlier</a></li>
<li class="chapter" data-level="11.5" data-path="robust-summaries.html"><a href="robust-summaries.html#desvio-absoluto-mediano"><i class="fa fa-check"></i><b>11.5</b> Desvio absoluto mediano</a></li>
<li class="chapter" data-level="11.6" data-path="robust-summaries.html"><a href="robust-summaries.html#exercícios-21"><i class="fa fa-check"></i><b>11.6</b> Exercícios</a></li>
<li class="chapter" data-level="11.7" data-path="robust-summaries.html"><a href="robust-summaries.html#estudo-de-caso-altura-do-aluno-autorreferida"><i class="fa fa-check"></i><b>11.7</b> Estudo de caso: altura do aluno autorreferida</a></li>
</ul></li>
<li class="part"><span><b>III Estatísticas com R</b></span></li>
<li class="chapter" data-level="12" data-path="introdução-à-estatística-com-r.html"><a href="introdução-à-estatística-com-r.html"><i class="fa fa-check"></i><b>12</b> Introdução à estatística com R</a></li>
<li class="chapter" data-level="13" data-path="probabilidade.html"><a href="probabilidade.html"><i class="fa fa-check"></i><b>13</b> Probabilidade</a>
<ul>
<li class="chapter" data-level="13.1" data-path="probabilidade.html"><a href="probabilidade.html#probabilidade-discreta"><i class="fa fa-check"></i><b>13.1</b> Probabilidade discreta</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="probabilidade.html"><a href="probabilidade.html#frequência-relativa"><i class="fa fa-check"></i><b>13.1.1</b> Frequência relativa</a></li>
<li class="chapter" data-level="13.1.2" data-path="probabilidade.html"><a href="probabilidade.html#notação"><i class="fa fa-check"></i><b>13.1.2</b> Notação</a></li>
<li class="chapter" data-level="13.1.3" data-path="probabilidade.html"><a href="probabilidade.html#distribuições-de-probabilidade"><i class="fa fa-check"></i><b>13.1.3</b> Distribuições de probabilidade</a></li>
<li class="chapter" data-level="13.1.4" data-path="probabilidade.html"><a href="probabilidade.html#defina-a-semente-aleatória"><i class="fa fa-check"></i><b>13.1.4</b> Defina a semente aleatória</a></li>
<li class="chapter" data-level="13.1.5" data-path="probabilidade.html"><a href="probabilidade.html#com-e-sem-substituição"><i class="fa fa-check"></i><b>13.1.5</b> Com e sem substituição</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="probabilidade.html"><a href="probabilidade.html#independência"><i class="fa fa-check"></i><b>13.2</b> Independência</a></li>
<li class="chapter" data-level="13.3" data-path="probabilidade.html"><a href="probabilidade.html#probabilidades-condicionais"><i class="fa fa-check"></i><b>13.3</b> Probabilidades condicionais</a></li>
<li class="chapter" data-level="13.4" data-path="probabilidade.html"><a href="probabilidade.html#regras-de-adição-e-multiplicação"><i class="fa fa-check"></i><b>13.4</b> Regras de adição e multiplicação</a></li>
<li class="chapter" data-level="13.5" data-path="probabilidade.html"><a href="probabilidade.html#combinações-e-permutações"><i class="fa fa-check"></i><b>13.5</b> Combinações e permutações</a></li>
<li class="chapter" data-level="13.6" data-path="probabilidade.html"><a href="probabilidade.html#exemplos"><i class="fa fa-check"></i><b>13.6</b> Exemplos</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="probabilidade.html"><a href="probabilidade.html#problema-de-aniversário"><i class="fa fa-check"></i><b>13.6.1</b> Problema de aniversário</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="probabilidade.html"><a href="probabilidade.html#exercícios-22"><i class="fa fa-check"></i><b>13.7</b> Exercícios</a></li>
<li class="chapter" data-level="13.8" data-path="probabilidade.html"><a href="probabilidade.html#probabilidade-contínua"><i class="fa fa-check"></i><b>13.8</b> Probabilidade contínua</a></li>
<li class="chapter" data-level="13.9" data-path="probabilidade.html"><a href="probabilidade.html#distribuições-teóricas-contínuas"><i class="fa fa-check"></i><b>13.9</b> Distribuições teóricas contínuas</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="probabilidade.html"><a href="probabilidade.html#distribuições-teóricas-como-aproximações"><i class="fa fa-check"></i><b>13.9.1</b> Distribuições teóricas como aproximações</a></li>
<li class="chapter" data-level="13.9.2" data-path="probabilidade.html"><a href="probabilidade.html#a-densidade-de-probabilidade"><i class="fa fa-check"></i><b>13.9.2</b> A densidade de probabilidade</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="probabilidade.html"><a href="probabilidade.html#distribuições-contínuas"><i class="fa fa-check"></i><b>13.10</b> Distribuições contínuas</a></li>
<li class="chapter" data-level="13.11" data-path="probabilidade.html"><a href="probabilidade.html#exercícios-23"><i class="fa fa-check"></i><b>13.11</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html"><i class="fa fa-check"></i><b>14</b> Variáveis aleatórias</a>
<ul>
<li class="chapter" data-level="14.1" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#variáveis-aleatórias-1"><i class="fa fa-check"></i><b>14.1</b> Variáveis aleatórias</a></li>
<li class="chapter" data-level="14.2" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#modelos-de-amostragem"><i class="fa fa-check"></i><b>14.2</b> Modelos de amostragem</a></li>
<li class="chapter" data-level="14.3" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#a-distribuição-de-probabilidade-de-uma-variável-aleatória"><i class="fa fa-check"></i><b>14.3</b> A distribuição de probabilidade de uma variável aleatória</a></li>
<li class="chapter" data-level="14.4" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#distribuições-versus-distribuições-de-probabilidade"><i class="fa fa-check"></i><b>14.4</b> Distribuições versus distribuições de probabilidade</a></li>
<li class="chapter" data-level="14.5" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#notação-para-variáveis-aleatórias"><i class="fa fa-check"></i><b>14.5</b> Notação para variáveis aleatórias</a></li>
<li class="chapter" data-level="14.6" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#o-valor-esperado-e-o-erro-padrão"><i class="fa fa-check"></i><b>14.6</b> O valor esperado e o erro padrão</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#desvio-padrão-da-população-versus-desvio-padrão-da-amostra"><i class="fa fa-check"></i><b>14.6.1</b> Desvio padrão da população versus desvio padrão da amostra</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#teorema-do-limite-central"><i class="fa fa-check"></i><b>14.7</b> Teorema do Limite Central</a></li>
<li class="chapter" data-level="14.8" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#propriedades-estatísticas-das-médias"><i class="fa fa-check"></i><b>14.8</b> Propriedades estatísticas das médias</a></li>
<li class="chapter" data-level="14.9" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#lei-dos-grandes-números"><i class="fa fa-check"></i><b>14.9</b> Lei dos grandes números</a>
<ul>
<li class="chapter" data-level="14.9.1" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#interpretação-incorreta-da-lei-das-médias"><i class="fa fa-check"></i><b>14.9.1</b> Interpretação incorreta da lei das médias</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#exercícios-24"><i class="fa fa-check"></i><b>14.10</b> Exercícios</a></li>
<li class="chapter" data-level="14.11" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#estudo-de-caso-the-big-short"><i class="fa fa-check"></i><b>14.11</b> Estudo de caso: <em>The Big Short</em></a>
<ul>
<li class="chapter" data-level="14.11.1" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#taxas-de-juros-explicadas-com-modelo-de-probabilidade"><i class="fa fa-check"></i><b>14.11.1</b> Taxas de juros explicadas com modelo de probabilidade</a></li>
<li class="chapter" data-level="14.11.2" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#the-big-short"><i class="fa fa-check"></i><b>14.11.2</b> <em>The Big Short</em></a></li>
</ul></li>
<li class="chapter" data-level="14.12" data-path="variáveis-aleatórias.html"><a href="variáveis-aleatórias.html#exercícios-25"><i class="fa fa-check"></i><b>14.12</b> Exercícios</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado com bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução à Ciência de Dados</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1" number="4">
<h1><span class="header-section-number">Capítulo 4</span> <em>tidyverse</em></h1>
<p>Até agora, manipulamos vetores reorganizando-os e criando subconjuntos indexando. No entanto, quando iniciamos as análises mais avançadas, a unidade preferida para armazenamento de dados não é o vetor, mas o <em>data frame</em>. Neste capítulo, aprenderemos a trabalhar diretamente com <em>data frames</em>, o que facilita muito a organização da informação. Usaremos <em>data frames</em> para a maior parte deste livro. Vamos nos concentrar em um formato de dados específico chamado <em>tidy_e uma coleção específica de pacotes que são particularmente úteis para trabalhar com dados_tidy_chamados_tidyverse</em>.</p>
<p>Podemos carregar todos os pacotes _tidyverse_de uma só vez instalando e carregando o pacote<strong>tidyverse</strong>:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="tidyverse.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Aprenderemos como implementar a abordagem <em>tidyverse</em> ao longo do livro, mas antes de nos aprofundarmos nos detalhes, neste capítulo, apresentaremos alguns dos aspectos mais comuns do <em>tidyverse</em>, começando com o pacote __dplyr__para manipular os quadros de dados e o pacote<strong>purrr</strong> para trabalhar com As funções. Observe que o <em>tidyverse</em> também inclui um pacote gráfico, <strong>ggplot2</strong>, que apresentaremos mais adiante neste capítulo. <a href="ggplot2.html#ggplot2">7</a> na parte “Visualização de dados” do livro; o pacote <strong>readr</strong> discutido no capítulo <a href="importing-data.html#importing-data">5</a>; e muitos outros. Neste capítulo, primeiro apresentamos o conceito de dados <em>tidy_e depois demonstramos como usamos_tidyverse_para trabalhar com_data frames</em> neste formato.</p>
<div id="tidy-data" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Data <em>tidy</em></h2>
<p>Dizemos que uma tabela de dados está no formato <em>tidy</em> se cada linha representa uma observação e as colunas representam as diferentes variáveis disponíveis para cada uma dessas observações. O conjunto de dados <code>murders</code> é um exemplo de um <em>tidy data frame</em>.</p>
<pre><code>#&gt;        state abb region population total
#&gt; 1    Alabama  AL  South    4779736   135
#&gt; 2     Alaska  AK   West     710231    19
#&gt; 3    Arizona  AZ   West    6392017   232
#&gt; 4   Arkansas  AR  South    2915918    93
#&gt; 5 California  CA   West   37253956  1257
#&gt; 6   Colorado  CO   West    5029196    65</code></pre>
<p>Cada linha representa um estado com cada uma das cinco colunas fornecendo uma variável diferente relacionada a esses estados: nome, abreviação, região, população e número total de assassinatos.</p>
<p>Para ver como as mesmas informações podem ser fornecidas em diferentes formatos, considere o seguinte exemplo:</p>
<pre><code>#&gt;       country year fertility
#&gt; 1     Germany 1960      2.41
#&gt; 2 South Korea 1960      6.16
#&gt; 3     Germany 1961      2.44
#&gt; 4 South Korea 1961      5.99
#&gt; 5     Germany 1962      2.47
#&gt; 6 South Korea 1962      5.79</code></pre>
<p>Este conjunto de dados <em>tidy</em> oferece taxas de fertilidade para dois países ao longo dos anos. Um conjunto de dados arrumado é considerado porque cada linha apresenta uma observação com as três variáveis: país, ano e taxa de fertilidade. No entanto, esse conjunto de dados originalmente veio em um formato diferente e o remodelamos para distribuição através do pacote <strong>dslabs</strong>. Originalmente, os dados estavam no seguinte formato:</p>
<pre><code>#&gt;       country 1960 1961 1962
#&gt; 1     Germany 2.41 2.44 2.47
#&gt; 2 South Korea 6.16 5.99 5.79</code></pre>
<p>A mesma informação é fornecida, mas há duas diferenças importantes no formato: 1) cada linha inclui várias observações e 2) uma das variáveis, ano, é armazenada no cabeçalho. Para que os pacotes <em>tidyverse</em> sejam utilizados da melhor maneira, precisamos alterar a forma dos dados para que estejam no formato <em>tidy</em>, que eles aprenderão na seção “<em>Wrangling</em> data” do livro. Até lá, usaremos exemplos de conjuntos de dados que já estão no formato <em>tidy</em>.</p>
<p>Embora não seja imediatamente óbvio, ao longo do livro, você começará a apreciar os benefícios de trabalhar em uma estrutura em que as funções usam os formatos <em>tidy_para_inputs_e_outputs</em>. Você verá como isso permite que os analistas de dados se concentrem nos aspectos mais importantes da análise, e não no formato dos dados.</p>
</div>
<div id="exercícios-8" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Exercícios</h2>
<p>1. Examine o conjunto de dados incluído na base R <code>co2</code>. Qual dos seguintes é verdadeiro?</p>
<p>para. <code>co2</code> <em>tidy</em> data: possui um ano para cada linha.
b. <code>co2</code> not <em>tidy</em>: precisamos de pelo menos uma coluna com um vetor de caracteres.
c. <code>co2</code> não é <em>tidy</em>: é uma matriz em vez de um <em>data frame</em>.
d. <code>co2</code> não é arrumado: para arrumar, teríamos que mudar a forma (em inglês) para ter três colunas (ano, mês e valor), e então cada observação de CO2 teria uma linha.</p>
<p>2. Examine o conjunto de dados incluído na base R <code>ChickWeight</code>. Qual dos seguintes é verdadeiro?</p>
<p>para. <code>ChickWeight</code> não <em>tidy</em>: cada pintinho tem mais de uma linha.
b. <code>ChickWeight</code> is_tidy_: cada observação (um peso) é representada por uma linha. O pintinho de onde essa medição veio é uma das variáveis.
c. <code>ChickWeight</code> não é arrumado: estamos perdendo a coluna do ano.
d. <code>ChickWeight</code> é <em>tidy</em>: é armazenado em um <em>data frame</em>.</p>
<p>3. Examine o conjunto de dados predefinido <code>BOD</code>. Qual dos seguintes é verdadeiro?</p>
<p>para. <code>BOD</code> não é arrumado: tem apenas seis linhas.
b. <code>BOD</code> not <em>tidy</em>: a primeira coluna é apenas um índice.
c. <code>BOD</code> é <em>tidy</em>: cada linha é uma observação com dois valores (tempo e demanda)
d. <code>BOD</code> é <em>tidy</em>: todos os conjuntos de dados pequenos são <em>tidy</em> por definição.</p>
<p>4. Qual dos seguintes conjuntos de dados internos é <em>tidy</em>? Você pode escolher mais de um.</p>
<p>para. <code>BJsales</code>
b. <code>EuStockMarkets</code>
c. <code>DNase</code>
d. <code>Formaldehyde</code>
e. <code>Orange</code>
f. <code>UCBAdmissions</code></p>
</div>
<div id="como-manipular-data-frames" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Como manipular <em>data frames</em></h2>
<p>O pacote __dplyr_<em>do_tidyverse_oferece funções que executam algumas das operações mais comuns ao trabalhar com_data frames</em> e usa nomes para essas funções que são relativamente fáceis de lembrar. Por exemplo, para alterar a tabela de dados adicionando uma nova coluna, usamos <code>mutate</code>. Para filtrar a tabela de dados para um subconjunto de linhas, usamos <code>filter</code>. Por fim, para subdividir os dados selecionando colunas específicas, usamos <code>select</code>.</p>
<div id="como-adicionar-uma-coluna-com-mutate" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Como adicionar uma coluna com <code>mutate</code></h3>
<p>Queremos que todas as informações necessárias para nossa análise sejam incluídas na tabela de dados. Portanto, a primeira tarefa é adicionar as taxas de assassinato ao nosso quadro de dados de assassinatos. A função <code>mutate</code> pegue <em>data frame</em> como primeiro argumento e nome da variável e valores como segundo argumento usando a convenção <code>name = values</code>. Então, para adicionar taxas de assassinatos, usamos:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="tidyverse.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb159-2"><a href="tidyverse.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;murders&quot;</span>)</span>
<span id="cb159-3"><a href="tidyverse.html#cb159-3" aria-hidden="true" tabindex="-1"></a>murders <span class="ot">&lt;-</span> <span class="fu">mutate</span>(murders, <span class="at">rate =</span> total<span class="sc">/</span> population <span class="sc">*</span> <span class="dv">100000</span>)</span></code></pre></div>
<p>Lembre-se que aqui usamos <code>total</code> e <code>population</code> dentro da função, que são objetos <strong>não</strong> definidos em nossa área de trabalho. Mas por que não recebemos um erro?</p>
<p>Este é um dos principais recursos do <strong>dplyr</strong>. As funções neste pacote, como <code>mutate</code> eles sabem como procurar variáveis no <em>data frame</em> que o primeiro argumento fornece. Na chamada para <code>mutate</code> que vemos acima, <code>total</code> terá os valores de <code>murders$total</code>. Essa abordagem torna o código muito mais legível.</p>
<p>Podemos ver que a nova coluna foi adicionada:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="tidyverse.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(murders)</span>
<span id="cb160-2"><a href="tidyverse.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        state abb region population total rate</span></span>
<span id="cb160-3"><a href="tidyverse.html#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    Alabama  AL  South    4779736   135 2.82</span></span>
<span id="cb160-4"><a href="tidyverse.html#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     Alaska  AK   West     710231    19 2.68</span></span>
<span id="cb160-5"><a href="tidyverse.html#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    Arizona  AZ   West    6392017   232 3.63</span></span>
<span id="cb160-6"><a href="tidyverse.html#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   Arkansas  AR  South    2915918    93 3.19</span></span>
<span id="cb160-7"><a href="tidyverse.html#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 California  CA   West   37253956  1257 3.37</span></span>
<span id="cb160-8"><a href="tidyverse.html#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   Colorado  CO   West    5029196    65 1.29</span></span></code></pre></div>
<p>Embora tenhamos substituído o objeto original <code>murders</code>, isso não altera o objeto que foi carregado com <code>data(murders)</code>. Se carregarmos os dados <code>murders</code> novamente, o original substituirá nossa versão mutada.</p>
</div>
<div id="como-criar-subconjuntos-com-filter" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Como criar subconjuntos com <code>filter</code></h3>
<p>Agora, suponha que desejamos filtrar a tabela de dados para mostrar apenas as entradas para as quais a taxa de homicídios é menor que 0,71. Para fazer isso, usamos a função <code>filter</code>, que usa a tabela de dados como o primeiro argumento e, em seguida, a instrução condicional como o segundo. O mesmo que com <code>mutate</code>, podemos usar nomes de variáveis sem aspas de <code>murders</code> dentro da função e ele saberá que estamos nos referindo às colunas e não aos objetos na área de trabalho.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="tidyverse.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(murders, rate <span class="sc">&lt;=</span> <span class="fl">0.71</span>)</span>
<span id="cb161-2"><a href="tidyverse.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           state abb        region population total  rate</span></span>
<span id="cb161-3"><a href="tidyverse.html#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        Hawaii  HI          West    1360301     7 0.515</span></span>
<span id="cb161-4"><a href="tidyverse.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          Iowa  IA North Central    3046355    21 0.689</span></span>
<span id="cb161-5"><a href="tidyverse.html#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 New Hampshire  NH     Northeast    1316470     5 0.380</span></span>
<span id="cb161-6"><a href="tidyverse.html#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  North Dakota  ND North Central     672591     4 0.595</span></span>
<span id="cb161-7"><a href="tidyverse.html#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       Vermont  VT     Northeast     625741     2 0.320</span></span></code></pre></div>
</div>
<div id="como-selecionar-colunas-com-select" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Como selecionar colunas com <code>select</code></h3>
<p>Embora nossa tabela de dados tenha apenas seis colunas, algumas tabelas de dados incluem centenas. Se queremos ver apenas algumas colunas, podemos usar a função <code>select</code> de <strong>dplyr</strong>. No código a seguir, selecionamos três, atribuímos o resultado a um novo objeto e filtramos esse novo objeto:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="tidyverse.html#cb162-1" aria-hidden="true" tabindex="-1"></a>new_table <span class="ot">&lt;-</span> <span class="fu">select</span>(murders, state, region, rate)</span>
<span id="cb162-2"><a href="tidyverse.html#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(new_table, rate <span class="sc">&lt;=</span> <span class="fl">0.71</span>)</span>
<span id="cb162-3"><a href="tidyverse.html#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           state        region  rate</span></span>
<span id="cb162-4"><a href="tidyverse.html#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        Hawaii          West 0.515</span></span>
<span id="cb162-5"><a href="tidyverse.html#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          Iowa North Central 0.689</span></span>
<span id="cb162-6"><a href="tidyverse.html#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 New Hampshire     Northeast 0.380</span></span>
<span id="cb162-7"><a href="tidyverse.html#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  North Dakota North Central 0.595</span></span>
<span id="cb162-8"><a href="tidyverse.html#cb162-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       Vermont     Northeast 0.320</span></span></code></pre></div>
<p>Na chamada para <code>select</code>, o primeiro argumento <code>murders</code> é um objeto mas <code>state</code>, <code>region</code> e <code>rate</code> eles são nomes de variáveis.</p>
</div>
</div>
<div id="exercícios-9" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Exercícios</h2>
<p>1. Carregue o pacote <strong>dplyr</strong> e o conjunto de dados de assassinato nos EUA.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="tidyverse.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb163-2"><a href="tidyverse.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb163-3"><a href="tidyverse.html#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(murders)</span></code></pre></div>
<p>Você pode adicionar colunas usando a função <code>mutate</code> de <strong>dplyr</strong>. Esta função reconhece os nomes das colunas e, dentro da função, você pode chamá-los sem aspas:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="tidyverse.html#cb164-1" aria-hidden="true" tabindex="-1"></a>murders <span class="ot">&lt;-</span> <span class="fu">mutate</span>(murders, <span class="at">population_in_millions =</span> population<span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>)</span></code></pre></div>
<p>Nós podemos escrever <code>population</code> em vez de <code>murders$population</code>. A função <code>mutate</code> sabemos que estamos agarrando colunas de <code>murders</code>.</p>
<p>Usar função <code>mutate</code> para adicionar uma coluna de assassinato chamada <code>rate</code> com a taxa de homicídios por 100.000, como no código do exemplo acima. Certifique-se de redefinir <code>murders</code> como foi feito no código do exemplo anterior (assassinatos &lt;- [seu código]) para que possamos continuar usando essa variável.</p>
<p>2. Sim <code>rank(x)</code> fornece o alcance das entradas <code>x</code> do menor para o maior, <code>rank(-x)</code> fornece os intervalos do maior para o menor. Usar função <code>mutate</code> adicionar uma coluna <code>rank</code> a contendo a faixa de taxa de homicídios da maior para a menor. Certifique-se de redefinir <code>murders</code> para continuar usando esta variável.</p>
<p>3. Com <strong>dplyr</strong>, podemos usar <code>select</code> para mostrar apenas determinadas colunas. Por exemplo, com este código, mostraríamos apenas os estados e tamanhos da população:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="tidyverse.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(murders, state, population) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<p>Usar <code>select</code> para exibir nomes e abreviações de estado em <code>murders</code>. Não redefina <code>murders</code>, apenas mostre os resultados.</p>
<p>4. A função <code>filter</code> __dplyr_<em>é usado para escolher linhas específicas do_data frame</em> para salvar. A diferença de <code>select</code> que é para colunas, <code>filter</code> é para linhas. Por exemplo, você pode exibir apenas a linha de Nova York da seguinte maneira:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="tidyverse.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(murders, state <span class="sc">==</span> <span class="st">&quot;New York&quot;</span>)</span></code></pre></div>
<p>Você pode usar outros vetores lógicos para filtrar linhas.</p>
<p>Usar <code>filter</code> para mostrar os cinco estados com as maiores taxas de homicídio. Depois de adicionar a taxa e o intervalo de assassinatos, não altere o conjunto de dados de assassinatos nos EUA. EUA, apenas mostre o resultado. Lembre-se de que você pode filtrar com base na coluna <code>rank</code>.</p>
<p>5. Podemos excluir linhas usando o operador <code>!=</code>. Por exemplo, para remover a Flórida, faríamos o seguinte:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="tidyverse.html#cb167-1" aria-hidden="true" tabindex="-1"></a>no_florida <span class="ot">&lt;-</span> <span class="fu">filter</span>(murders, state <span class="sc">!=</span> <span class="st">&quot;Florida&quot;</span>)</span></code></pre></div>
<p>Crie um novo <em>data frame</em> com o nome <code>no_south</code> isso elimina os estados da região sul. Quantos estados há nesta categoria? Você pode usar a função <code>nrow</code> para isto.</p>
<p>6. Também podemos usar <code>%in%</code> para filtrar com <strong>dplyr</strong>. Portanto, você pode visualizar os dados de Nova York e Texas como este:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="tidyverse.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(murders, state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;New York&quot;</span>, <span class="st">&quot;Texas&quot;</span>))</span></code></pre></div>
<p>Crie um novo <em>data frame</em> chamado <code>murders_nw</code> apenas com os estados nordeste e oeste. Quantos estados há nesta categoria?</p>
<p>7. Suponha que você queira morar no nordeste ou oeste <strong>e</strong> que a taxa de homicídios seja menor que 1. Queremos ver os dados dos estados que satisfazem essas opções. Observe que você pode usar operadores lógicos com <code>filter</code>. Aqui está um exemplo em que filtramos para manter apenas pequenos estados na região nordeste.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="tidyverse.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(murders, population <span class="sc">&lt;</span> <span class="dv">5000000</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">&quot;Northeast&quot;</span>)</span></code></pre></div>
<p>Certifique-se de que <code>murders</code> foi definido com <code>rate</code> e <code>rank</code> e ainda tem todos os estados. Crie uma tabela chamada <code>my_states</code> contendo linhas para estados que satisfazem ambas as condições: é no nordeste ou oeste e a taxa de homicídios é menor que 1. <code>select</code> para exibir apenas o nome, a taxa e o intervalo do estado.</p>
</div>
<div id="o-cano_" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> O cano_: <code>%&gt;%</code></h2>
<p>Com <strong>dplyr</strong>, podemos executar uma série de operações, por exemplo <code>select</code> e então <code>filter</code>, enviando os resultados de uma função para outra usando o que é chamado de <em>pipe operator</em>: <code>%&gt;%</code>. Alguns detalhes estão incluídos abaixo.</p>
<p>Escrevemos o código acima para mostrar três variáveis (estado, região, taxa) para estados com taxas de homicídio abaixo de 0,71. Para isso, definimos o objeto intermediário <code>new_table</code>. Em <strong>dplyr</strong>, podemos escrever um código mais parecido com uma descrição do que queremos fazer sem objetos intermediários:</p>
<p><span class="math display">\[ \mbox {original data }
\rightarrow \mbox { select }
\rightarrow \mbox { filter } \]</span></p>
<p>Para essa operação, podemos usar o <em>pipe</em> <code>%&gt;%</code>. O código fica assim:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="tidyverse.html#cb170-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span> <span class="fu">select</span>(state, region, rate) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rate <span class="sc">&lt;=</span> <span class="fl">0.71</span>)</span>
<span id="cb170-2"><a href="tidyverse.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           state        region  rate</span></span>
<span id="cb170-3"><a href="tidyverse.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        Hawaii          West 0.515</span></span>
<span id="cb170-4"><a href="tidyverse.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          Iowa North Central 0.689</span></span>
<span id="cb170-5"><a href="tidyverse.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 New Hampshire     Northeast 0.380</span></span>
<span id="cb170-6"><a href="tidyverse.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  North Dakota North Central 0.595</span></span>
<span id="cb170-7"><a href="tidyverse.html#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       Vermont     Northeast 0.320</span></span></code></pre></div>
<p>Essa linha de código é equivalente às duas linhas de código anteriores. O que está acontecendo aqui?</p>
<p>Em geral, o <em>pipe_envia o resultado que está no lado esquerdo do_pipe_para ser o primeiro argumento da função no lado direito do_pipe</em>. Aqui está um exemplo simples:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="tidyverse.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="sc">%&gt;%</span> <span class="fu">sqrt</span>()</span>
<span id="cb171-2"><a href="tidyverse.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span></code></pre></div>
<p>Podemos continuar canalizando valores (<em>piping</em> em inglês) ao longo de:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="tidyverse.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="sc">%&gt;%</span> <span class="fu">sqrt</span>() <span class="sc">%&gt;%</span> <span class="fu">log2</span>()</span>
<span id="cb172-2"><a href="tidyverse.html#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>A declaração acima é equivalente a <code>log2(sqrt(16))</code>.</p>
<p>Lembre-se de que o <em>pipe</em> envia valores para o primeiro argumento, para que possamos definir outros argumentos como se o primeiro argumento já estivesse definido:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="tidyverse.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="sc">%&gt;%</span> <span class="fu">sqrt</span>() <span class="sc">%&gt;%</span> <span class="fu">log</span>(<span class="at">base =</span> <span class="dv">2</span>)</span>
<span id="cb173-2"><a href="tidyverse.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Portanto, ao usar _pipe_com_data frames_e<strong>dplyr</strong>, não precisamos mais especificar o primeiro argumento necessário, pois as funções <strong>dplyr</strong> que descrevemos pegam todos os dados como o primeiro argumento. No código que escrevemos:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="tidyverse.html#cb174-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span> <span class="fu">select</span>(state, region, rate) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rate <span class="sc">&lt;=</span> <span class="fl">0.71</span>)</span></code></pre></div>
<p><code>murders</code> é o primeiro argumento da função <code>select</code> e o novo <em>data frame</em> (anteriormente <code>new_table</code>) é o primeiro argumento da função <code>filter</code>.</p>
<p>Observe que o <em>pipe</em> funciona bem com funções em que o primeiro argumento são os dados de entrada. As funções nos pacotes __tidyverse__e__dplyr_<em>têm esse formato e podem ser facilmente usadas com o_pipe</em>.</p>
</div>
<div id="exercícios-10" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Exercícios</h2>
<p>1. O cano_ <code>%&gt;%</code> ele pode ser usado para executar operações sequencialmente sem precisar definir objetos intermediários. Comece redefinindo <em>murders</em> para incluir a taxa e o intervalo.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="tidyverse.html#cb175-1" aria-hidden="true" tabindex="-1"></a>murders <span class="ot">&lt;-</span> <span class="fu">mutate</span>(murders, <span class="at">rate =</span> total<span class="sc">/</span> population <span class="sc">*</span> <span class="dv">100000</span>,</span>
<span id="cb175-2"><a href="tidyverse.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="at">rank =</span> <span class="fu">rank</span>(<span class="sc">-</span>rate))</span></code></pre></div>
<p>Na solução do exercício anterior, fizemos o seguinte:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="tidyverse.html#cb176-1" aria-hidden="true" tabindex="-1"></a>my_states <span class="ot">&lt;-</span> <span class="fu">filter</span>(murders, region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;West&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb176-2"><a href="tidyverse.html#cb176-2" aria-hidden="true" tabindex="-1"></a>rate <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb176-3"><a href="tidyverse.html#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="tidyverse.html#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(my_states, state, rate, rank)</span></code></pre></div>
<p>O cano_ <code>%&gt;%</code> nos permite executar as duas operações sequencialmente sem precisar definir uma variável intermediária <code>my_states</code>. Então, poderíamos ter mudado e selecionado na mesma linha assim:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="tidyverse.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(murders, <span class="at">rate =</span> total<span class="sc">/</span> population <span class="sc">*</span> <span class="dv">100000</span>,</span>
<span id="cb177-2"><a href="tidyverse.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="at">rank =</span> <span class="fu">rank</span>(<span class="sc">-</span>rate)) <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="tidyverse.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(state, rate, rank)</span></code></pre></div>
<p>Eu sinto isso <code>select</code> ele não possui mais um <em>data frame</em> como seu primeiro argumento. O primeiro argumento é assumido como o resultado da operação realizada imediatamente antes <code>%&gt;%</code>.</p>
<p>Repita o exercício anterior, mas agora, em vez de criar um novo objeto, mostre o resultado e inclua apenas as colunas de status, velocidade e intervalo. Use um <em>pipe</em> <code>%&gt;%</code> para fazer isso em uma linha.</p>
<p>2. Reiniciar <code>murders</code> para a tabela original usando <code>data(murders)</code>. Use um <em>pipe_para criar um novo_data frame</em> chamado <code>my_states</code> ele considera apenas os estados do nordeste ou oeste que têm uma taxa de homicídios menor que 1 e contém apenas as colunas de estado, taxa e faixa. O <em>pipe</em> também deve ter quatro componentes separados por três <code>%&gt;%</code>. O código deve se parecer com o seguinte:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="tidyverse.html#cb178-1" aria-hidden="true" tabindex="-1"></a>my_states <span class="ot">&lt;-</span> murders <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="tidyverse.html#cb178-2" aria-hidden="true" tabindex="-1"></a>mutate SOMETHING <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="tidyverse.html#cb178-3" aria-hidden="true" tabindex="-1"></a>filter SOMETHING <span class="sc">%&gt;%</span></span>
<span id="cb178-4"><a href="tidyverse.html#cb178-4" aria-hidden="true" tabindex="-1"></a>select SOMETHING</span></code></pre></div>
</div>
<div id="como-resumir-dados" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Como resumir dados</h2>
<p>Uma parte importante da análise exploratória de dados é resumir os dados. A média e o desvio padrão são dois exemplos de estatísticas resumidas amplamente usadas. É possível obter resumos mais informativos, dividindo primeiro os dados em grupos. Nesta seção, abordamos dois novos verbos <strong>dplyr</strong> que facilitam esses cálculos: <code>summarize</code> e <code>group_by</code>. Aprendemos a acessar os valores resultantes usando a função <code>pull</code>.</p>
<div id="summarize" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> <code>summarize</code></h3>
<p>A função <code>summarize</code> o de <strong>dplyr</strong> oferece uma maneira de calcular estatísticas resumidas com código intuitivo e legível. Começamos com um exemplo simples baseado em alturas. O conjunto de dados <code>heights</code> inclui as alturas e o sexo relatados pelos alunos em uma pesquisa de classe.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="tidyverse.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb179-2"><a href="tidyverse.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb179-3"><a href="tidyverse.html#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(heights)</span></code></pre></div>
<p>O código a seguir calcula a média e o desvio padrão para mulheres:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="tidyverse.html#cb180-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> heights <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="tidyverse.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="tidyverse.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">average =</span> <span class="fu">mean</span>(height), <span class="at">standard_deviation =</span> <span class="fu">sd</span>(height))</span>
<span id="cb180-4"><a href="tidyverse.html#cb180-4" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb180-5"><a href="tidyverse.html#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   average standard_deviation</span></span>
<span id="cb180-6"><a href="tidyverse.html#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    64.9               3.76</span></span></code></pre></div>
<p>Isso leva nossa tabela de dados original como entrada, a filtra para incluir apenas as linhas que representam as fêmeas e, em seguida, produz uma nova tabela de resumo com apenas a média e o desvio padrão das alturas. Podemos escolher os nomes das colunas da tabela resultante. Por exemplo, acima, decidimos usar <code>average</code> e <code>standard_deviation</code>, mas poderíamos ter usado outros nomes da mesma maneira.</p>
<p>Como a tabela resultante armazenada em <code>s</code> é um <em>data frame</em>, podemos acessar os componentes com o operador de acesso <code>$</code>:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="tidyverse.html#cb181-1" aria-hidden="true" tabindex="-1"></a>s<span class="sc">$</span>average</span>
<span id="cb181-2"><a href="tidyverse.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 64.9</span></span>
<span id="cb181-3"><a href="tidyverse.html#cb181-3" aria-hidden="true" tabindex="-1"></a>s<span class="sc">$</span>standard_deviation</span>
<span id="cb181-4"><a href="tidyverse.html#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.76</span></span></code></pre></div>
<p>Como na maioria das outras funções <strong>dplyr</strong>, <code>summarize</code> conhece os nomes das variáveis e podemos usá-las diretamente. Então, quando escrevemos <code>mean(height)</code> dentro da chamada de função <code>summarize</code>, a função acessa a coluna denominada “height” ou height e calcula a média do vetor numérico resultante. Podemos calcular qualquer outro resumo que opere em vetores e retorne um único valor. Por exemplo, podemos adicionar as medianas, alturas mínima e máxima desta maneira:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="tidyverse.html#cb182-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="tidyverse.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="tidyverse.html#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">median =</span> <span class="fu">median</span>(height), <span class="at">minimum =</span> <span class="fu">min</span>(height),</span>
<span id="cb182-4"><a href="tidyverse.html#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="at">maximum =</span> <span class="fu">max</span>(height))</span>
<span id="cb182-5"><a href="tidyverse.html#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   median minimum maximum</span></span>
<span id="cb182-6"><a href="tidyverse.html#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     65      51      79</span></span></code></pre></div>
<p>Podemos obter esses três valores com apenas uma linha usando a função <code>quantile</code>: por exemplo, <code>quantile(x, c(0,0.5,1))</code> retorna o mínimo (percentil 0), mediana (percentil 50) e máximo (percentil 100) do vetor <code>x</code>. No entanto, se tentarmos usar uma função como essa que retorne dois ou mais valores dentro <code>summarize</code>:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="tidyverse.html#cb183-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb183-2"><a href="tidyverse.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-3"><a href="tidyverse.html#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">range =</span> <span class="fu">quantile</span>(height, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)))</span></code></pre></div>
<p>receberemos um erro: <code>Error: expecting result of length one, got : 2</code>. Com função <code>summarize</code>, podemos chamar apenas funções que retornam um único valor. Na seção <a href="tidyverse.html#do">4.12</a> vamos aprender a lidar com funções que retornam mais de um valor.</p>
<p>Para outro exemplo de como podemos usar a função <code>summarize</code> vamos calcular a taxa média de homicídios nos Estados Unidos. Lembre-se de que nossa tabela de dados inclui o total de assassinatos e o tamanho da população de cada estado e já usamos <strong>dplyr</strong> para adicionar uma coluna de taxa de assassinatos:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="tidyverse.html#cb184-1" aria-hidden="true" tabindex="-1"></a>murders <span class="ot">&lt;-</span> murders <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rate =</span> total<span class="sc">/</span>population<span class="sc">*</span><span class="dv">100000</span>)</span></code></pre></div>
<p>Lembre-se que a taxa de homicídios nos EUA EUA <strong>não</strong> é a média das taxas de homicídio do estado:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="tidyverse.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(murders, <span class="fu">mean</span>(rate))</span>
<span id="cb185-2"><a href="tidyverse.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   mean(rate)</span></span>
<span id="cb185-3"><a href="tidyverse.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       2.78</span></span></code></pre></div>
<p>Isso ocorre porque no cálculo anterior, estados pequenos têm o mesmo peso que estados grandes. A taxa de assassinatos nos Estados Unidos é o número total de assassinatos nos Estados Unidos dividido pela população total. Portanto, o cálculo correto é:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="tidyverse.html#cb186-1" aria-hidden="true" tabindex="-1"></a>us_murder_rate <span class="ot">&lt;-</span> murders <span class="sc">%&gt;%</span></span>
<span id="cb186-2"><a href="tidyverse.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">rate =</span> <span class="fu">sum</span>(total)<span class="sc">/</span> <span class="fu">sum</span>(population) <span class="sc">*</span> <span class="dv">100000</span>)</span>
<span id="cb186-3"><a href="tidyverse.html#cb186-3" aria-hidden="true" tabindex="-1"></a>us_murder_rate</span>
<span id="cb186-4"><a href="tidyverse.html#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   rate</span></span>
<span id="cb186-5"><a href="tidyverse.html#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 3.03</span></span></code></pre></div>
<p>Este cálculo conta estados maiores proporcionalmente ao seu tamanho, resultando em um valor maior.</p>
</div>
<div id="pull" class="section level3" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> <code>pull</code></h3>
<p>O objeto <code>us_murder_rate</code> definido acima representa apenas um número. No entanto, estamos armazenando-o em um <em>data frame</em>:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="tidyverse.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(us_murder_rate)</span>
<span id="cb187-2"><a href="tidyverse.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span></code></pre></div>
<p>desde que, como a maioria das funções <strong>dplyr</strong>, <code>summarize</code> sempre retorna um <em>data frame</em>.</p>
<p>Isso pode ser problemático se quisermos usar esse resultado com funções que requerem um valor numérico. Aqui está um truque útil para acessar os valores armazenados nos dados quando usamos <em>pipes</em>: quando um objeto de dados é canalizado (_ é canalizado em inglês), esse objeto e suas colunas podem ser acessados usando a função <code>pull</code>. Para entender o que queremos dizer, considere esta linha de código:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="tidyverse.html#cb188-1" aria-hidden="true" tabindex="-1"></a>us_murder_rate <span class="sc">%&gt;%</span> <span class="fu">pull</span>(rate)</span>
<span id="cb188-2"><a href="tidyverse.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.03</span></span></code></pre></div>
<p>Isso retorna o valor na coluna <code>rate</code> do <code>us_murder_rate</code> tornando-o equivalente a <code>us_murder_rate$rate</code>.</p>
<p>Para obter um número da tabela de dados original com uma linha de código, podemos escrever:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="tidyverse.html#cb189-1" aria-hidden="true" tabindex="-1"></a>us_murder_rate <span class="ot">&lt;-</span> murders <span class="sc">%&gt;%</span></span>
<span id="cb189-2"><a href="tidyverse.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">rate =</span> <span class="fu">sum</span>(total)<span class="sc">/</span> <span class="fu">sum</span>(population) <span class="sc">*</span> <span class="dv">100000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="tidyverse.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pull</span>(rate)</span>
<span id="cb189-4"><a href="tidyverse.html#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="tidyverse.html#cb189-5" aria-hidden="true" tabindex="-1"></a>us_murder_rate</span>
<span id="cb189-6"><a href="tidyverse.html#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.03</span></span></code></pre></div>
<p>que agora é numérico:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="tidyverse.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(us_murder_rate)</span>
<span id="cb190-2"><a href="tidyverse.html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;numeric&quot;</span></span></code></pre></div>
</div>
<div id="group-by" class="section level3" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Como agrupar e resumir com <code>group_by</code></h3>
<p>Uma operação comum na exploração de dados é primeiro dividir os dados em grupos e depois calcular resumos para cada grupo. Por exemplo, podemos querer calcular a média e o desvio padrão para as alturas de homens e mulheres separadamente. A função <code>group_by</code> nos ajuda a fazer isso.</p>
<p>Se escrevermos isso:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="tidyverse.html#cb191-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sex)</span>
<span id="cb191-2"><a href="tidyverse.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,050 x 2</span></span>
<span id="cb191-3"><a href="tidyverse.html#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   sex [2]</span></span>
<span id="cb191-4"><a href="tidyverse.html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   sex   height</span></span>
<span id="cb191-5"><a href="tidyverse.html#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;dbl&gt;</span></span>
<span id="cb191-6"><a href="tidyverse.html#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Male      75</span></span>
<span id="cb191-7"><a href="tidyverse.html#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Male      70</span></span>
<span id="cb191-8"><a href="tidyverse.html#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Male      68</span></span>
<span id="cb191-9"><a href="tidyverse.html#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Male      74</span></span>
<span id="cb191-10"><a href="tidyverse.html#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Male      61</span></span>
<span id="cb191-11"><a href="tidyverse.html#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1,045 more rows</span></span></code></pre></div>
<p>O resultado não parece muito diferente de <code>heights</code> exceto que vemos <code>Groups: sex [2]</code> quando imprimimos o objeto. Embora não seja imediatamente óbvio a partir de sua aparência, agora é um <em>data frame_especial</em> chamado <em>data de dados agrupados</em>, e as funções de <strong>dplyr</strong>, em particular <code>summarize</code>, eles se comportarão de maneira diferente quando agirem sobre esse objeto. Conceitualmente, eles podem pensar nessa tabela como muitas tabelas, com as mesmas colunas, mas não necessariamente com o mesmo número de linhas, empilhadas em um objeto. Quando resumimos os dados após o agrupamento, é o que acontece:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="tidyverse.html#cb192-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="tidyverse.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb192-3"><a href="tidyverse.html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">average =</span> <span class="fu">mean</span>(height), <span class="at">standard_deviation =</span> <span class="fu">sd</span>(height))</span>
<span id="cb192-4"><a href="tidyverse.html#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span></span>
<span id="cb192-5"><a href="tidyverse.html#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 x 3</span></span>
<span id="cb192-6"><a href="tidyverse.html#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   sex    average standard_deviation</span></span>
<span id="cb192-7"><a href="tidyverse.html#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;    &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span id="cb192-8"><a href="tidyverse.html#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Female    64.9               3.76</span></span>
<span id="cb192-9"><a href="tidyverse.html#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Male      69.3               3.61</span></span></code></pre></div>
<p>A função <code>summarize</code> aplique o resumo a cada grupo separadamente.</p>
<p>Para ver outro exemplo, vamos calcular a taxa média de homicídios nas quatro regiões do país:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="tidyverse.html#cb193-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="tidyverse.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="tidyverse.html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">median_rate =</span> <span class="fu">median</span>(rate))</span>
<span id="cb193-4"><a href="tidyverse.html#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span></span>
<span id="cb193-5"><a href="tidyverse.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 x 2</span></span>
<span id="cb193-6"><a href="tidyverse.html#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   region        median_rate</span></span>
<span id="cb193-7"><a href="tidyverse.html#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt;</span></span>
<span id="cb193-8"><a href="tidyverse.html#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Northeast            1.80</span></span>
<span id="cb193-9"><a href="tidyverse.html#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 South                3.40</span></span>
<span id="cb193-10"><a href="tidyverse.html#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 North Central        1.97</span></span>
<span id="cb193-11"><a href="tidyverse.html#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 West                 1.29</span></span></code></pre></div>
</div>
</div>
<div id="como-encomendar-os-data-frames" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Como encomendar os <em>data frames</em></h2>
<p>Ao examinar um conjunto de dados, geralmente é conveniente classificar numericamente ou alfabeticamente, com base em uma ou mais das colunas da tabela. Conhecemos as funções <code>order</code> e <code>sort</code>, mas para classificar tabelas inteiras, a função <code>arrange</code> <strong>dplyr</strong> é útil. Por exemplo, aqui ordenamos os estados de acordo com o tamanho da população:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="tidyverse.html#cb194-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb194-2"><a href="tidyverse.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(population) <span class="sc">%&gt;%</span></span>
<span id="cb194-3"><a href="tidyverse.html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>()</span>
<span id="cb194-4"><a href="tidyverse.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  state abb        region population total   rate</span></span>
<span id="cb194-5"><a href="tidyverse.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              Wyoming  WY          West     563626     5  0.887</span></span>
<span id="cb194-6"><a href="tidyverse.html#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 District of Columbia  DC         South     601723    99 16.453</span></span>
<span id="cb194-7"><a href="tidyverse.html#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3              Vermont  VT     Northeast     625741     2  0.320</span></span>
<span id="cb194-8"><a href="tidyverse.html#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4         North Dakota  ND North Central     672591     4  0.595</span></span>
<span id="cb194-9"><a href="tidyverse.html#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5               Alaska  AK          West     710231    19  2.675</span></span>
<span id="cb194-10"><a href="tidyverse.html#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6         South Dakota  SD North Central     814180     8  0.983</span></span></code></pre></div>
<p>Com <code>arrange</code> podemos decidir qual coluna usar para solicitar. Para ver os estados por população, do menor para o maior, organizamos pela <code>rate</code> :</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="tidyverse.html#cb195-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb195-2"><a href="tidyverse.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(rate) <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="tidyverse.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>()</span>
<span id="cb195-4"><a href="tidyverse.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           state abb        region population total  rate</span></span>
<span id="cb195-5"><a href="tidyverse.html#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       Vermont  VT     Northeast     625741     2 0.320</span></span>
<span id="cb195-6"><a href="tidyverse.html#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 New Hampshire  NH     Northeast    1316470     5 0.380</span></span>
<span id="cb195-7"><a href="tidyverse.html#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        Hawaii  HI          West    1360301     7 0.515</span></span>
<span id="cb195-8"><a href="tidyverse.html#cb195-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  North Dakota  ND North Central     672591     4 0.595</span></span>
<span id="cb195-9"><a href="tidyverse.html#cb195-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5          Iowa  IA North Central    3046355    21 0.689</span></span>
<span id="cb195-10"><a href="tidyverse.html#cb195-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6         Idaho  ID          West    1567582    12 0.766</span></span></code></pre></div>
<p>Observe que o comportamento padrão é classificar em ordem crescente. Em <strong>dplyr</strong>, a função <code>desc</code> transformar um vetor para que fique em ordem decrescente. Para classificar a tabela em ordem decrescente, podemos escrever:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="tidyverse.html#cb196-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="tidyverse.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(<span class="fu">desc</span>(rate))</span></code></pre></div>
<div id="como-encomendar-aninhado" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Como encomendar aninhado</h3>
<p>Se estivermos ordenando uma coluna quando houver empates, podemos usar uma segunda coluna para quebrar o empate. Da mesma forma, uma terceira coluna pode ser usada para romper os laços entre a primeira e a segunda, e assim por diante. Aqui nós ordenamos por <code>region</code>, na região, ordenamos por taxa de homicídio:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="tidyverse.html#cb197-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="tidyverse.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(region, rate) <span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="tidyverse.html#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>()</span>
<span id="cb197-4"><a href="tidyverse.html#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           state abb    region population total  rate</span></span>
<span id="cb197-5"><a href="tidyverse.html#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       Vermont  VT Northeast     625741     2 0.320</span></span>
<span id="cb197-6"><a href="tidyverse.html#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 New Hampshire  NH Northeast    1316470     5 0.380</span></span>
<span id="cb197-7"><a href="tidyverse.html#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3         Maine  ME Northeast    1328361    11 0.828</span></span>
<span id="cb197-8"><a href="tidyverse.html#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  Rhode Island  RI Northeast    1052567    16 1.520</span></span>
<span id="cb197-9"><a href="tidyverse.html#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Massachusetts  MA Northeast    6547629   118 1.802</span></span>
<span id="cb197-10"><a href="tidyverse.html#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      New York  NY Northeast   19378102   517 2.668</span></span></code></pre></div>
</div>
<div id="os-primeiros-n" class="section level3" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Os primeiros <span class="math inline">\(n\)</span></h3>
<p>No código acima, usamos a função <code>head</code> para impedir que a página seja preenchida com todo o conjunto de dados. Se queremos ver uma proporção maior, podemos usar a função <code>top_n</code>. Essa função usa um <em>data frame</em> como o primeiro argumento, o número de linhas a serem exibidas no segundo e a variável a ser filtrada no terceiro. Aqui está um exemplo de como visualizar as 5 principais linhas:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="tidyverse.html#cb198-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="dv">5</span>, rate)</span>
<span id="cb198-2"><a href="tidyverse.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  state abb        region population total  rate</span></span>
<span id="cb198-3"><a href="tidyverse.html#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 District of Columbia  DC         South     601723    99 16.45</span></span>
<span id="cb198-4"><a href="tidyverse.html#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2            Louisiana  LA         South    4533372   351  7.74</span></span>
<span id="cb198-5"><a href="tidyverse.html#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             Maryland  MD         South    5773552   293  5.07</span></span>
<span id="cb198-6"><a href="tidyverse.html#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             Missouri  MO North Central    5988927   321  5.36</span></span>
<span id="cb198-7"><a href="tidyverse.html#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       South Carolina  SC         South    4625364   207  4.48</span></span></code></pre></div>
<p>Observe que as linhas não são ordenadas por <code>rate</code>, apenas filtrado. Se quisermos pedir, precisamos usar <code>arrange</code>. Lembre-se de que, se o terceiro argumento for deixado em branco, <code>top_n</code> filtrar pela última coluna.</p>
</div>
</div>
<div id="exercícios-11" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Exercícios</h2>
<p>Para esses exercícios, usaremos os dados da pesquisa coletados pelo Centro Nacional de Estatísticas da Saúde dos Estados Unidos (NCHS). Este centro realiza uma série de pesquisas em saúde e nutrição desde a década de 1960. Desde 1999, cerca de 5.000 indivíduos de todas as idades foram entrevistadas a cada ano e concluíram o componente de triagem de saúde da pesquisa. Alguns dos dados estão disponíveis no pacote <strong>NHANES</strong>. Depois de instalar o pacote <strong>NHANES</strong>, eles podem carregar os dados da seguinte maneira:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="tidyverse.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb199-2"><a href="tidyverse.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(NHANES)</span></code></pre></div>
<p>Os dados <strong>NHANES</strong> têm muitos valores ausentes. As funções <code>mean</code> e <code>sd</code> retornará <code>NA</code> se alguma das entradas do vetor de entrada for uma <code>NA</code>. Aqui está um exemplo:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="tidyverse.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb200-2"><a href="tidyverse.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(na_example)</span>
<span id="cb200-3"><a href="tidyverse.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(na_example)</span>
<span id="cb200-4"><a href="tidyverse.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb200-5"><a href="tidyverse.html#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(na_example)</span>
<span id="cb200-6"><a href="tidyverse.html#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>Para ignorar o <code>NA</code> s podemos usar o argumento <code>na.rm</code>:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="tidyverse.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(na_example, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb201-2"><a href="tidyverse.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.3</span></span>
<span id="cb201-3"><a href="tidyverse.html#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(na_example, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb201-4"><a href="tidyverse.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.22</span></span></code></pre></div>
<p>Vamos agora explorar os dados <strong>NHANES</strong>.</p>
<p>1. Oferecemos algumas informações básicas sobre pressão arterial. Primeiro, vamos selecionar um grupo para definir o padrão. Usaremos mulheres de 20 a 29 anos. <code>AgeDecade</code> é uma variável categórica com essas idades. Observe que a categoria está codificada “20-29,” com um espaço na frente! Qual é a média e desvio padrão da pressão arterial sistólica, conforme armazenado na variável <code>BPSysAve</code>? Salve-o em uma variável chamada <code>ref</code>.</p>
<p>Dica: use <code>filter</code> e <code>summarize</code> e use o argumento <code>na.rm = TRUE</code> ao calcular a média e o desvio padrão. Você também pode filtrar valores de NA usando <code>filter</code>.</p>
<p>2. Usando um <em>pipe</em>, atribua a média a uma variável numérica <code>ref_avg</code>. Dica: use o código semelhante ao acima e depois <code>pull</code>.</p>
<p>3. Agora insira os valores mínimo e máximo para o mesmo grupo.</p>
<p>4. Calcule a média e o desvio padrão para as mulheres, mas para cada faixa etária separadamente, em vez de uma década selecionada, como na pergunta 1. Observe que as faixas etárias são definidas por <code>AgeDecade</code>. Dica: em vez de filtrar por idade e sexo, filtre por <code>Gender</code> e depois use <code>group_by</code>.</p>
<p>5. Repita o exercício 4 para os meninos.</p>
<p>6. Podemos combinar os dois resumos dos exercícios 4 e 5 em uma linha de código. Isto é porque <code>group_by</code> permite agrupar por mais de uma variável. Obtenha uma excelente tabela de resumo usando <code>group_by(AgeDecade, Gender)</code>.</p>
<p>7. Para homens entre 40 e 49 anos, compare a pressão arterial sistólica por raça, conforme aparece na variável <code>Race1</code>. Encomende a tabela resultante com base na pressão arterial sistólica média mais baixa para a mais alta.</p>
</div>
<div id="tibbles" class="section level2" number="4.10">
<h2><span class="header-section-number">4.10</span> <em>Tibbles</em></h2>
<p>Os dados <em>tidy_devem ser armazenados em_data frames</em>. Discutimos o <em>data frame</em> na Seção <a href="r-basics.html#data-frames">2.4.1</a> e estamos usando o <em>data frame</em> <code>murders</code> ao longo do livro. Na seção <a href="tidyverse.html#group-by">4.7.3</a> nós introduzimos a função <code>group_by</code>, que permite estratificar os dados antes de calcular as estatísticas de resumo. Mas onde estão as informações do grupo armazenadas no <em>data frame</em>?</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="tidyverse.html#cb202-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(region)</span>
<span id="cb202-2"><a href="tidyverse.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 51 x 6</span></span>
<span id="cb202-3"><a href="tidyverse.html#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   region [4]</span></span>
<span id="cb202-4"><a href="tidyverse.html#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   state      abb   region population total  rate</span></span>
<span id="cb202-5"><a href="tidyverse.html#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt; &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb202-6"><a href="tidyverse.html#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Alabama    AL    South     4779736   135  2.82</span></span>
<span id="cb202-7"><a href="tidyverse.html#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Alaska     AK    West       710231    19  2.68</span></span>
<span id="cb202-8"><a href="tidyverse.html#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Arizona    AZ    West      6392017   232  3.63</span></span>
<span id="cb202-9"><a href="tidyverse.html#cb202-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Arkansas   AR    South     2915918    93  3.19</span></span>
<span id="cb202-10"><a href="tidyverse.html#cb202-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 California CA    West     37253956  1257  3.37</span></span>
<span id="cb202-11"><a href="tidyverse.html#cb202-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 46 more rows</span></span></code></pre></div>
<p>Observe que não há colunas com essas informações. Mas se você olhar para a saída acima, verá a linha <code>A tibble</code> seguido por dimensões. Podemos aprender a classe do objeto retornado usando:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="tidyverse.html#cb203-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> <span class="fu">class</span>()</span>
<span id="cb203-2"><a href="tidyverse.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;grouped_df&quot; &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</span></span></code></pre></div>
<p>O <code>tbl</code> é um tipo especial de <em>data frame</em>. As funções <code>group_by</code> e <code>summarize</code> sempre retorne esse tipo de <em>data frame</em>. A função <code>group_by</code> retorna um tipo especial de <code>tbl</code>, a <code>grouped_df</code>. Discutiremos isso mais tarde. Para consistência, os verbos de manipulação <strong>dplyr</strong> ( <code>select</code>, <code>filter</code>, <code>mutate</code> e <code>arrange</code>) preserva a classe <em>input</em>: se eles recebem um <em>data frame</em> regular, eles retornam um <em>data frame</em> regular, enquanto que se eles recebem um <em>tibble</em>, eles retornam um tibble. Mas <em>tibbles_é o formato preferido_tidyverse</em> e, como resultado, funções <em>tidyverse_que produzem um_data frame_do zero retornam uma_tibble</em>. Por exemplo, no capítulo <a href="importing-data.html#importing-data">5</a> veremos que as funções <em>tidyverse_usadas para importar dados criam_tibbles</em>.</p>
<p><em>Tibbles_são muito semelhantes aos_data frames</em>. De fato, eles podem pensar neles como uma versão moderna de <em>data frames</em>. No entanto, existem três diferenças importantes que descreveremos abaixo.</p>
<div id="tibbles-parece-melhor" class="section level3" number="4.10.1">
<h3><span class="header-section-number">4.10.1</span> <em>Tibbles</em> parece melhor</h3>
<p>O método de impressão para <em>tibbles_é mais legível que o de um_data frame</em>. Para ver isso, compare a <em>saída</em> da digitação <code>murders</code> e a saída dos assassinatos, se os tornarmos uma tagarelice. Podemos fazer isso usando <code>as_tibble(murders)</code>. Se você usa o RStudio, a saída_de_tabela_ ajusta-se ao tamanho da sua janela. Para ver isso, altere a largura do seu console R e observe como mais/ menos colunas são exibidas.</p>
</div>
<div id="tibbles_subconjuntos-são_tibbles" class="section level3" number="4.10.2">
<h3><span class="header-section-number">4.10.2</span> <em>Tibbles_subconjuntos são_tibbles</em></h3>
<p>Se criarmos subconjuntos das colunas de um <em>data frame</em>, eles poderão retornar um objeto que não seja <em>data frame</em>, como um vetor ou escalar. Por exemplo:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="tidyverse.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(murders[,<span class="dv">4</span>])</span>
<span id="cb204-2"><a href="tidyverse.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;numeric&quot;</span></span></code></pre></div>
<p>não é um <em>data frame</em>. Com <em>tibbles</em> isso não acontece:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="tidyverse.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">as_tibble</span>(murders)[,<span class="dv">4</span>])</span>
<span id="cb205-2"><a href="tidyverse.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</span></span></code></pre></div>
<p>Isso é útil em <em>tidyverse</em>, pois as funções requerem <em>data frames_como_input</em>.</p>
<p>Com <em>tibbles</em>, se você deseja acessar o vetor que define uma coluna e não recuperar um <em>data frame</em>, deve usar o operador de acesso <code>$</code>:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="tidyverse.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">as_tibble</span>(murders)<span class="sc">$</span>population)</span>
<span id="cb206-2"><a href="tidyverse.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;numeric&quot;</span></span></code></pre></div>
<p>Um recurso relacionado é que <em>tibbles</em> avisará se eles tentarem acessar uma coluna que não existe. Por exemplo, se escrevermos acidentalmente <code>Population</code> ao invés de <code>population</code> nós vemos que:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="tidyverse.html#cb207-1" aria-hidden="true" tabindex="-1"></a>murders<span class="sc">$</span>Population</span>
<span id="cb207-2"><a href="tidyverse.html#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>retorna um <code>NULL</code> sem aviso, o que pode dificultar a depuração. Por outro lado, se tentarmos isso com uma <em>tibble</em>, obteremos um aviso informativo:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="tidyverse.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(murders)<span class="sc">$</span>Population</span>
<span id="cb208-2"><a href="tidyverse.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Unknown or uninitialised column: `Population`.</span></span>
<span id="cb208-3"><a href="tidyverse.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
<div id="tibbles-pode-ter-entradas-complexas" class="section level3" number="4.10.3">
<h3><span class="header-section-number">4.10.3</span> <em>Tibbles</em> pode ter entradas complexas</h3>
<p>Embora as colunas do <em>data frame</em> devam ser vetores de números, cadeias ou valores lógicos, <em>tibbles</em> pode ter objetos mais complexos, como listas ou funções. Além disso, podemos criar <em>tibbles</em> com funções:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="tidyverse.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">func =</span> <span class="fu">c</span>(mean, median, sd))</span>
<span id="cb209-2"><a href="tidyverse.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 x 2</span></span>
<span id="cb209-3"><a href="tidyverse.html#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      id func  </span></span>
<span id="cb209-4"><a href="tidyverse.html#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;list&gt;</span></span>
<span id="cb209-5"><a href="tidyverse.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1 &lt;fn&gt;  </span></span>
<span id="cb209-6"><a href="tidyverse.html#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2 &lt;fn&gt;  </span></span>
<span id="cb209-7"><a href="tidyverse.html#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     3 &lt;fn&gt;</span></span></code></pre></div>
</div>
<div id="tibbles-podem-ser-agrupados" class="section level3" number="4.10.4">
<h3><span class="header-section-number">4.10.4</span> <em>Tibbles</em> podem ser agrupados</h3>
<p>A função <code>group_by</code> retorna um tipo especial de <em>tibble</em>: um <em>tibble</em> agrupado. Essa classe armazena informações que permitem saber quais linhas estão em quais grupos. Funções <em>Tidyverse</em>, em particular a função <code>summarize</code>, estão cientes das informações do grupo.</p>
</div>
<div id="como-criar-um-tibble-usando-tibble-ao-invés-de-data.frame" class="section level3" number="4.10.5">
<h3><span class="header-section-number">4.10.5</span> Como criar um <em>tibble</em> usando <code>tibble</code> ao invés de <code>data.frame</code></h3>
<p>Às vezes, é útil criarmos nossos próprios <em>data frames</em>. Para criar um <em>data frame_no formato_tibble</em>, você pode usar a função <code>tibble</code>.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="tidyverse.html#cb210-1" aria-hidden="true" tabindex="-1"></a>grades <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Jean&quot;</span>, <span class="st">&quot;Yao&quot;</span>),</span>
<span id="cb210-2"><a href="tidyverse.html#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="at">exam_1 =</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">85</span>),</span>
<span id="cb210-3"><a href="tidyverse.html#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="at">exam_2 =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">90</span>))</span></code></pre></div>
<p>Observe que a base R (nenhum pacote carregado) tem uma função com um nome muito semelhante, <code>data.frame</code>, que pode ser usado para criar um <em>data frame_regular</em> em vez de um <em>tibble</em>. Outra diferença importante é que, por padrão <code>data.frame</code> forçar a conversão de caracteres em fatores sem fornecer um aviso ou mensagem:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="tidyverse.html#cb211-1" aria-hidden="true" tabindex="-1"></a>grades <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Jean&quot;</span>, <span class="st">&quot;Yao&quot;</span>),</span>
<span id="cb211-2"><a href="tidyverse.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="at">exam_1 =</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">85</span>),</span>
<span id="cb211-3"><a href="tidyverse.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="at">exam_2 =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">90</span>))</span>
<span id="cb211-4"><a href="tidyverse.html#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(grades<span class="sc">$</span>names)</span>
<span id="cb211-5"><a href="tidyverse.html#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;character&quot;</span></span></code></pre></div>
<p>Para evitar isso, usamos o argumento bastante complicado <code>stringsAsFactors</code>:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="tidyverse.html#cb212-1" aria-hidden="true" tabindex="-1"></a>grades <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Jean&quot;</span>, <span class="st">&quot;Yao&quot;</span>),</span>
<span id="cb212-2"><a href="tidyverse.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="at">exam_1 =</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">85</span>),</span>
<span id="cb212-3"><a href="tidyverse.html#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="at">exam_2 =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">90</span>),</span>
<span id="cb212-4"><a href="tidyverse.html#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-5"><a href="tidyverse.html#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(grades<span class="sc">$</span>names)</span>
<span id="cb212-6"><a href="tidyverse.html#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;character&quot;</span></span></code></pre></div>
<p>Para converter um <em>data frame_normal em um_tibble</em>, você pode usar a função <code>as_tibble</code>.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="tidyverse.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(grades) <span class="sc">%&gt;%</span> <span class="fu">class</span>()</span>
<span id="cb213-2"><a href="tidyverse.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</span></span></code></pre></div>
</div>
</div>
<div id="o-operador-de-ponto" class="section level2" number="4.11">
<h2><span class="header-section-number">4.11</span> O operador de ponto</h2>
<p>Uma das vantagens de usar o <em>pipe</em> <code>%&gt;%</code> é que não precisamos continuar nomeando novos objetos enquanto manipulamos o <em>data frame</em>. Lembre-se de que, se quisermos calcular a taxa média de homicídios nos estados do sul, em vez de escrever:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="tidyverse.html#cb214-1" aria-hidden="true" tabindex="-1"></a>tab_1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(murders, region <span class="sc">==</span> <span class="st">&quot;South&quot;</span>)</span>
<span id="cb214-2"><a href="tidyverse.html#cb214-2" aria-hidden="true" tabindex="-1"></a>tab_2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(tab_1, <span class="at">rate =</span> total<span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb214-3"><a href="tidyverse.html#cb214-3" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">&lt;-</span> tab_2<span class="sc">$</span>rate</span>
<span id="cb214-4"><a href="tidyverse.html#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(rates)</span>
<span id="cb214-5"><a href="tidyverse.html#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.4</span></span></code></pre></div>
<p>podemos evitar definir novos objetos intermediários escrevendo:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="tidyverse.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(murders, region <span class="sc">==</span> <span class="st">&quot;South&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb215-2"><a href="tidyverse.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">rate =</span> total<span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="tidyverse.html#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">median =</span> <span class="fu">median</span>(rate)) <span class="sc">%&gt;%</span></span>
<span id="cb215-4"><a href="tidyverse.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pull</span>(median)</span>
<span id="cb215-5"><a href="tidyverse.html#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.4</span></span></code></pre></div>
<p>Podemos fazer isso porque cada uma dessas funções usa um <em>data frame</em> como o primeiro argumento. Mas e se quisermos acessar um componente do <em>data frame</em>? Por exemplo, e se a função <code>pull</code> não está disponível e queremos acessar <code>tab_2$rate</code>? Que nome de quadro de dados usamos? A resposta é o operador de ponto (<em>dot operator</em> em inglês).</p>
<p>Por exemplo, para acessar o vetor de velocidade sem a função <code>pull</code>, poderíamos usar:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="tidyverse.html#cb216-1" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">&lt;-</span><span class="fu">filter</span>(murders, region <span class="sc">==</span> <span class="st">&quot;South&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb216-2"><a href="tidyverse.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">rate =</span> total<span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb216-3"><a href="tidyverse.html#cb216-3" aria-hidden="true" tabindex="-1"></a>.<span class="sc">$</span>rate</span>
<span id="cb216-4"><a href="tidyverse.html#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(rates)</span>
<span id="cb216-5"><a href="tidyverse.html#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.4</span></span></code></pre></div>
<p>Na próxima seção, veremos outras instâncias nas quais usar o <code>.</code> é útil.</p>
</div>
<div id="do" class="section level2" number="4.12">
<h2><span class="header-section-number">4.12</span> <code>do</code></h2>
<p>As funções <em>tidyverse_sabem como interpretar_tibbles</em> agrupados. Além disso, para facilitar o script através do <em>pipe</em> <code>%&gt;%</code> as funções <em>tidyverse_retornam constantemente_data frames</em>, pois isso garante que a saída de uma função seja aceita como a entrada de outra. Mas a maioria das funções R não reconhece <em>tibbles_agrupados nem retorna_data frames</em>. A função <code>quantile</code> é um exemplo que descrevemos na seção <a href="tidyverse.html#summarize">4.7.1</a>. A função <code>do</code> serve como uma ponte entre as funções de R, como <code>quantile</code> e o <em>tidyverse</em>. A função <code>do</code> entende <em>tibbles_agrupados e sempre retorna um_data frame</em>.</p>
<p>Na seção <a href="tidyverse.html#summarize">4.7.1</a>, percebemos que, se tentarmos usar <code>quantile</code> para obter o mínimo, a mediana e o máximo de uma chamada, receberemos um erro: <code>Error: expecting result of length one, got : 2</code>.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="tidyverse.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(heights)</span>
<span id="cb217-2"><a href="tidyverse.html#cb217-2" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb217-3"><a href="tidyverse.html#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb217-4"><a href="tidyverse.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">range =</span> <span class="fu">quantile</span>(height, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)))</span></code></pre></div>
<p>Nós podemos usar a função <code>do</code> para corrigir isso.</p>
<p>Primeiro, precisamos escrever uma função que se ajuste ao foco do <em>tidyverse</em>: isto é, ele recebe um <em>data frame_e retorna um_data frame</em>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="tidyverse.html#cb218-1" aria-hidden="true" tabindex="-1"></a>my_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(dat){</span>
<span id="cb218-2"><a href="tidyverse.html#cb218-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">quantile</span>(dat<span class="sc">$</span>height, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb218-3"><a href="tidyverse.html#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">min =</span> x[<span class="dv">1</span>], <span class="at">median =</span> x[<span class="dv">2</span>], <span class="at">max =</span> x[<span class="dv">3</span>])</span>
<span id="cb218-4"><a href="tidyverse.html#cb218-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Agora podemos aplicar a função ao conjunto de dados de altura para obter os resumos:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="tidyverse.html#cb219-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="tidyverse.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb219-3"><a href="tidyverse.html#cb219-3" aria-hidden="true" tabindex="-1"></a>my_summary</span>
<span id="cb219-4"><a href="tidyverse.html#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb219-5"><a href="tidyverse.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     min median   max</span></span>
<span id="cb219-6"><a href="tidyverse.html#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb219-7"><a href="tidyverse.html#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    50   68.5  82.7</span></span></code></pre></div>
<p>Mas não é isso que queremos. Queremos um resumo para cada gênero e o código retornou apenas um resumo. Isto é porque <code>my_summary</code> não faz parte do <em>tidyverse_e não sabe como lidar com os_tibbles</em> agrupados. <code>do</code> faz esta conexão:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="tidyverse.html#cb220-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb220-2"><a href="tidyverse.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb220-3"><a href="tidyverse.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">do</span>(<span class="fu">my_summary</span>(.))</span>
<span id="cb220-4"><a href="tidyverse.html#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 x 4</span></span>
<span id="cb220-5"><a href="tidyverse.html#cb220-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   sex [2]</span></span>
<span id="cb220-6"><a href="tidyverse.html#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   sex      min median   max</span></span>
<span id="cb220-7"><a href="tidyverse.html#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb220-8"><a href="tidyverse.html#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Female    51   65.0  79  </span></span>
<span id="cb220-9"><a href="tidyverse.html#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Male      50   69    82.7</span></span></code></pre></div>
<p>Lembre-se de que aqui precisamos usar o operador de ponto. O <em>tibble</em> criado por <code>group_by</code> é canalizado para <code>do</code>. Dentro da chamada para <code>do</code>, o nome dessa <em>tibble</em> é <code>.</code> e queremos enviá-lo para <code>my_summary</code>. Se eles não usarem o ponto, então <code>my_summary</code> ele não tem argumento e retorna um erro nos dizendo que o <code>argument "dat"</code> . Você pode ver o erro digitando:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="tidyverse.html#cb221-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb221-2"><a href="tidyverse.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb221-3"><a href="tidyverse.html#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="fu">do</span>(<span class="fu">my_summary</span>())</span></code></pre></div>
<p>Se eles não usarem parênteses, a função não será executada e, em vez disso, <code>do</code> tente retornar a função. Isso dá um erro porque <code>do</code> você sempre deve retornar um <em>data frame</em>. Você pode ver o erro digitando:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="tidyverse.html#cb222-1" aria-hidden="true" tabindex="-1"></a>heights <span class="sc">%&gt;%</span></span>
<span id="cb222-2"><a href="tidyverse.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb222-3"><a href="tidyverse.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">do</span>(my_summary)</span></code></pre></div>
</div>
<div id="o-pacote-purrr" class="section level2" number="4.13">
<h2><span class="header-section-number">4.13</span> O pacote <strong>purrr</strong></h2>
<p>Na seção <a href="conceitos-básicos-de-programação.html#vectorization">3.5</a> nós aprendemos sobre função <code>sapply</code>, o que nos permitiu aplicar a mesma função a cada elemento de um vetor. Criamos uma função e usamos <code>sapply</code> para calcular a soma do primeiro <code>n</code> números inteiros para vários valores de <code>n</code> assim:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="tidyverse.html#cb223-1" aria-hidden="true" tabindex="-1"></a>compute_s_n <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb223-2"><a href="tidyverse.html#cb223-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb223-3"><a href="tidyverse.html#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)</span>
<span id="cb223-4"><a href="tidyverse.html#cb223-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-5"><a href="tidyverse.html#cb223-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb223-6"><a href="tidyverse.html#cb223-6" aria-hidden="true" tabindex="-1"></a>s_n <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n, compute_s_n)</span></code></pre></div>
<p>Esse tipo de operação, que aplica a mesma função ou procedimento aos elementos de um objeto, é bastante comum na análise de dados. O pacote <strong>purrr</strong> inclui funções semelhantes a <code>sapply</code> mas eles interagem melhor com outras funções <em>tidyverse</em>. A principal vantagem é que podemos controlar melhor o tipo de resultado das funções. Por contraste, <code>sapply</code> você pode retornar vários tipos diferentes de objetos, convertendo-os quando conveniente. As funções <strong>purrr</strong> nunca farão isso: elas retornarão objetos de um tipo específico ou retornarão um erro se isso não for possível.</p>
<p>A primeira função de <strong>purrr</strong> que aprenderemos é <code>map</code>, que funciona muito semelhante a <code>sapply</code> mas sempre, sem exceção, ele retorna uma lista:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="tidyverse.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb224-2"><a href="tidyverse.html#cb224-2" aria-hidden="true" tabindex="-1"></a>s_n <span class="ot">&lt;-</span> <span class="fu">map</span>(n, compute_s_n)</span>
<span id="cb224-3"><a href="tidyverse.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(s_n)</span>
<span id="cb224-4"><a href="tidyverse.html#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;list&quot;</span></span></code></pre></div>
<p>Se queremos um vetor numérico, podemos usar <code>map_dbl</code> que sempre retorna um vetor de valores numéricos.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="tidyverse.html#cb225-1" aria-hidden="true" tabindex="-1"></a>s_n <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(n, compute_s_n)</span>
<span id="cb225-2"><a href="tidyverse.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(s_n)</span>
<span id="cb225-3"><a href="tidyverse.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;numeric&quot;</span></span></code></pre></div>
<p>Isso produz os mesmos resultados que a chamada <code>sapply</code> que vemos acima.</p>
<p>Uma função __purrr_<em>particularmente útil para interagir com o resto do_tidyverse</em> é <code>map_df</code>, que sempre retorna um <em>tibble data frame</em>. No entanto, a função chamada deve retornar um vetor ou uma lista com nomes. Por esse motivo, o código a seguir resultaria em um erro <code>Argument 1 must have names</code>:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="tidyverse.html#cb226-1" aria-hidden="true" tabindex="-1"></a>s_n <span class="ot">&lt;-</span> <span class="fu">map_df</span>(n, compute_s_n)</span></code></pre></div>
<p>Precisamos alterar a função para corrigir isso:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="tidyverse.html#cb227-1" aria-hidden="true" tabindex="-1"></a>compute_s_n <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb227-2"><a href="tidyverse.html#cb227-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb227-3"><a href="tidyverse.html#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">sum =</span> <span class="fu">sum</span>(x))</span>
<span id="cb227-4"><a href="tidyverse.html#cb227-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb227-5"><a href="tidyverse.html#cb227-5" aria-hidden="true" tabindex="-1"></a>s_n <span class="ot">&lt;-</span> <span class="fu">map_df</span>(n, compute_s_n)</span></code></pre></div>
<p>O pacote <strong>purrr</strong> oferece muito mais funcionalidades não discutidas aqui. Para mais detalhes, você pode consultar [este recurso online] (<a href="https://jennybc.github.io/purrr-tutorial/" class="uri">https://jennybc.github.io/purrr-tutorial/</a>).</p>
</div>
<div id="os-condicionais-tidyverse" class="section level2" number="4.14">
<h2><span class="header-section-number">4.14</span> Os condicionais <em>tidyverse</em></h2>
<p>Uma análise de dados típica geralmente envolve uma ou mais operações condicionais. Na seção <a href="conceitos-básicos-de-programação.html#conditionals">3.1</a> nós descrevemos a função <code>ifelse</code>, que usaremos extensivamente neste livro. Nesta seção, apresentamos duas funções <strong>dplyr</strong> que oferecem funcionalidade adicional para executar operações condicionais.</p>
<div id="case_when" class="section level3" number="4.14.1">
<h3><span class="header-section-number">4.14.1</span> <code>case_when</code></h3>
<p>A função <code>case_when</code> é útil para vetorizar instruções condicionais. Isso é semelhante a <code>ifelse</code> mas pode gerar qualquer número de valores, em vez de apenas <code>TRUE</code> ou <code>FALSE</code>. Aqui está um exemplo que divide os números em negativo, positivo e 0:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="tidyverse.html#cb228-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb228-2"><a href="tidyverse.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">case_when</span>(x <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;Negative&quot;</span>, x <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;Positive&quot;</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Zero&quot;</span>)</span>
<span id="cb228-3"><a href="tidyverse.html#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Negative&quot; &quot;Negative&quot; &quot;Zero&quot;     &quot;Positive&quot; &quot;Positive&quot;</span></span></code></pre></div>
<p>Um uso comum dessa função é definir variáveis categóricas com base nas variáveis existentes. Por exemplo, suponha que desejamos comparar as taxas de homicídios em quatro grupos de estados: Nova Inglaterra, Costa Oeste, Sul e Outro. Para cada estado, primeiro perguntamos se está na Nova Inglaterra. Se a resposta for não, perguntamos se está na Costa Oeste e, se não, perguntamos se está no Sul e, se não, atribuímos uma das opções acima (<em>Outro</em>). Aqui vemos como usamos <code>case_when</code> para fazer isso:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="tidyverse.html#cb229-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb229-2"><a href="tidyverse.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb229-3"><a href="tidyverse.html#cb229-3" aria-hidden="true" tabindex="-1"></a>abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ME&quot;</span>, <span class="st">&quot;NH&quot;</span>, <span class="st">&quot;VT&quot;</span>, <span class="st">&quot;MA&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;CT&quot;</span>) <span class="sc">~</span> <span class="st">&quot;New England&quot;</span>,</span>
<span id="cb229-4"><a href="tidyverse.html#cb229-4" aria-hidden="true" tabindex="-1"></a>abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;OR&quot;</span>, <span class="st">&quot;CA&quot;</span>) <span class="sc">~</span> <span class="st">&quot;West Coast&quot;</span>,</span>
<span id="cb229-5"><a href="tidyverse.html#cb229-5" aria-hidden="true" tabindex="-1"></a>region <span class="sc">==</span> <span class="st">&quot;South&quot;</span> <span class="sc">~</span> <span class="st">&quot;South&quot;</span>,</span>
<span id="cb229-6"><a href="tidyverse.html#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Other&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb229-7"><a href="tidyverse.html#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb229-8"><a href="tidyverse.html#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">rate =</span> <span class="fu">sum</span>(total)<span class="sc">/</span> <span class="fu">sum</span>(population) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb229-9"><a href="tidyverse.html#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span></span>
<span id="cb229-10"><a href="tidyverse.html#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 x 2</span></span>
<span id="cb229-11"><a href="tidyverse.html#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group        rate</span></span>
<span id="cb229-12"><a href="tidyverse.html#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span id="cb229-13"><a href="tidyverse.html#cb229-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 New England  1.72</span></span>
<span id="cb229-14"><a href="tidyverse.html#cb229-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Other        2.71</span></span>
<span id="cb229-15"><a href="tidyverse.html#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 South        3.63</span></span>
<span id="cb229-16"><a href="tidyverse.html#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 West Coast   2.90</span></span></code></pre></div>
</div>
<div id="between" class="section level3" number="4.14.2">
<h3><span class="header-section-number">4.14.2</span> <code>between</code></h3>
<p>Uma operação comum na análise de dados é determinar se um valor cai dentro de um intervalo. Podemos verificar isso usando condicionais. Por exemplo, para verificar se os elementos de um vetor <code>x</code> estão entre <code>a</code> e <code>b</code> nós podemos escrever:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="tidyverse.html#cb230-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&gt;=</span> a <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> b</span></code></pre></div>
<p>No entanto, isso pode ficar complicado, especialmente dentro da abordagem <em>tidyverse</em>. A função <code>between</code> execute a mesma operação:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="tidyverse.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">between</span>(x, a, b)</span></code></pre></div>
</div>
</div>
<div id="exercícios-12" class="section level2" number="4.15">
<h2><span class="header-section-number">4.15</span> Exercícios</h2>
<p>1. Carregar o conjunto de dados <code>murders</code>. Qual dos seguintes é verdadeiro?</p>
<p>para. <code>murders</code> está no formato <em>tidy_e é armazenado em uma_tibble</em>.
b. <code>murders</code> está no formato <em>tidy_e é armazenado em um_data frame</em>.
c. <code>murders</code> não está no formato <em>tidy_e é armazenado em um_tibble</em>.
d. <code>murders</code> não está no formato <em>tidy_e é armazenado em um_data frame</em>.</p>
<p>2. Usar <code>as_tibble</code> converter a tabela de dados <code>murders</code> em uma <em>tibble</em> e salve-a em um objeto chamado <code>murders_tibble</code>.</p>
<p>3. Use a função <code>group_by</code> converter <code>murders</code> em uma <em>tibble</em> que é agrupada por região.</p>
<p>4. Escreva o código <em>tidyverse</em> que é equivalente a este código:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="tidyverse.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(murders<span class="sc">$</span>population)))</span></code></pre></div>
<p>Escreva usando o <em>pipe</em> para que cada função seja chamada sem argumentos. Use o operador de ponto para acessar a população. Dica: o código deve começar com <code>murders %&gt;%</code>.</p>
<p>5. Use o <code>map_df</code> para criar um <em>data frame</em> com três colunas denominadas <code>n</code>, <code>s_n</code> e <code>s_n_2</code>. A primeira coluna deve conter os números de 1 a 100. A segunda e a terceira coluna devem conter a soma de 1 a 100. <span class="math inline">\(n\)</span> com <span class="math inline">\(n\)</span> representando o número da linha.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="conceitos-básicos-de-programação.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="importing-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rafalab/dslivro/edit/master/R/tidyverse.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["livro.pdf", "livro.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
